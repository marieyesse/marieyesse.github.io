---
title: "Marieyesse"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Welcome to my corner of experimentation

  | 
---------------------- | ----------------------------------------
![](img/profile.jpg)            | Welcome to the webpage of MariÃ«sse (_"Marie-yes-se"_) van Sluisveld (PhD). I am a scientific employee at PBL Netherlands Environmental Assessment Agency,  using and producing data on a daily base to advise and support decision making on long-term systemic change. My little corner of creation will mostly function as an archive of achievement and wrapper for various short reads, data showcasings and code storage.

<br>
<br>

## My (potential) calendar:

```{r results=TRUE, message=FALSE, warning=FALSE, echo=FALSE,  fig.width=8, fig.height=4, }

#devtools::install_github("jayjacobs/ggcal", lib="C:/Program Files/R/R-3.5.2/library")
#library(ggcal)
library(ggplot2)
library(dplyr)
library(lubridate)
library(plotly)
library(cluster)
library(tibble)
library(forcats)

```

```{r message=FALSE, warning=FALSE, echo=FALSE, }
# editing ggcal by JayJacobs https://rdrr.io/github/jayjacobs/ggcal/src/R/ggcal.R to include additional info

ggcal <- function(dates, fills, activity) {
  # get ordered vector of month names
  months <- format(seq(as.Date("2016-01-01"), as.Date("2016-12-01"), by="1 month"), "%B")

  # get lower and upper bound to fill in missing values
  mindate <- as.Date(format(min(dates), "%Y-%m-01"))
  maxdate <- (seq(as.Date(format(max(dates), "%Y-%m-01")), length.out = 2, by="1 month")-1)[2]
  # set up tibble with all the dates.
  filler <- tibble(date = seq(mindate, maxdate, by="1 day"))

  t1 <- tibble(date = dates, fill=fills, alpha=activity) %>%
    right_join(filler, by="date") %>% # fill in missing dates with NA
    mutate(dow = as.numeric(format(date, "%w"))) %>%
    mutate(month = format(date, "%B")) %>%
    mutate(woy = as.numeric(format(date, "%U"))) %>%
    mutate(year = as.numeric(format(date, "%Y"))) %>%
    mutate(month = factor(month, levels=months, ordered=TRUE)) %>%
    arrange(year, month) %>%
    mutate(monlabel=month)

  if (length(unique(t1$year))>1) { # multi-year data set
    t1$monlabel <- paste(t1$month, t1$year)
  }

  t2 <- t1 %>%
    mutate(monlabel = factor(monlabel, ordered=TRUE)) %>%
    mutate(monlabel = fct_inorder(monlabel)) %>%
    mutate(monthweek = woy-min(woy),
           y=max(monthweek)-monthweek+1)

weekdays <- c("S", "M", "T", "W", "T", "F", "S")
ggplot(t2, aes(dow, y, fill=fill, alpha=as.factor(activity))) +
  geom_tile(color="gray80") +
  facet_wrap(~monlabel, ncol=3, scales="free") +
  scale_x_continuous(expand=c(0,0), position="top",
                     breaks=seq(0,6), labels=weekdays) +
  scale_y_continuous(expand=c(0,0)) +
  scale_alpha_discrete(breaks=c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10"), 
                      range = c(1,1,1,1,1,1,1,1,1,1)) +
  theme(panel.background=element_rect(fill=NA, color=NA),
        strip.background = element_rect(fill=NA, color=NA),
        strip.text.x = element_text(hjust=0, face="bold"),
        legend.title = element_blank(),
        axis.ticks=element_blank(),
        axis.title=element_blank(),
        axis.text.y = element_blank(),
        strip.placement = "outsite") +
  guides(alpha = F)
}

```


```{r results=TRUE, message=FALSE, warning=FALSE, echo=FALSE, fig.width=8, fig.height=5}

calendar = read.csv("data/calendar.csv", sep=",", dec=".")
calendar$Date <- as.Date(calendar$Date,  tryFormats = c("%d/%m/%Y"))

#complete calendar

last_day_in_file <- max(calendar$Date)
end_this_month <- as.Date(cut(last_day_in_file, "month")) + months(1) - 1
alldates <- data.frame(Date = seq.Date(min(calendar$Date), end_this_month, by ="1 day"))
calendar <- left_join(alldates, calendar) 

#ggcal plot ggcal(dates, fills)
CALENDAR <-  ggcal(calendar$Date, calendar$Class, calendar$What) +
  
  scale_fill_manual(name ="Activity",
    breaks=c(unique(calendar$Class)),
    values = c(
      "Conference" ="steelblue",
      "Deadline" ="red",
      "Stakeholder Workshop" = "orange",
      "Summer School" = "forestgreen"
      ),
    na.value ="grey88"
    ) +
  theme(plot.title = element_text(hjust=0.5),
        panel.spacing = unit(2, "lines")) +
  ggtitle("2019") 


hide_legend(ggplotly(CALENDAR, tooltip=c("Date","Class", "What")))  %>% config(displayModeBar = F)
  
# translate to numerical



```
