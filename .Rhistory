IEATOTDEMFUTbl=ggplot() +
#Removed , "Value Added|Industry"
geom_line(data=EMF28meltEU.stand[Variable %in% c("Final Energy|Industry", "Emissions|CO2|||Industry") & Scenario %in% c("EU1")], aes(x=Year, y=ByBL, colour=Study, group=Model), linetype=2 ) +
geom_line(data=EMF28meltEU.stand[Variable %in% c("Final Energy|Industry", "Emissions|CO2|||Industry") & Scenario %in% c("EU9")], aes(x=Year, y=ByBL, colour=Study, group=Model), size=1  ) +
geom_line(data=EIAETP2017, aes(x=Year, y=ByBL, colour=Study, group=Scenario), size=1 ) +
geom_line(data=ADAM, aes(x=Year, y=ByBL, colour=Study, group=Scenario), size=1 ) +
geom_line(data=Fragosdatacalc, aes(x=Year, y=ByBL, colour=Study, group=Scenario), size=1 ) +
#  # EMission intensity
#  geom_line(data=EMF28meltEUEmeff[Scenario=="EU9"], aes(x=Year, y=ByBL, colour=Study, group=Model), size=1 ) +
#  geom_line(data=EMF28meltEUEmeff[Scenario=="EU1"], aes(x=Year, y=ByBL, colour=Study, group=Model), linetype=2 ) +
# geom_line(data=EIAETP2017emeff[!Scenario.x=="BL"], aes(x=Year, y=ByBL, colour=Study, group=Scenario.x), size=1 ) +
# geom_line(data=EIAETP2017emeff[Scenario.x=="BL"], aes(x=Year, y=ByBL, colour=Study, group=Scenario.x), linetype=2 ) +
#  geom_line(data=ADAMemeff[!Scenario.x=="BL"], aes(x=Year, y=ByBL, colour=Study, group=Scenario.x), size=1 ) +
#  geom_line(data=ADAMemeff[Scenario.x=="BL"], aes(x=Year, y=ByBL, colour=Study, group=Scenario.x), linetype=2 ) +
#
#  ### Energy intensity (Value added intensitt)
#  geom_line(data=EMF28meltEUVAI[Variable=="Energy intensity" & Scenario=="EU9"], aes(x=Year, y=ByBL, colour=Study, group=Model), size=1 ) +
#  geom_line(data=EMF28meltEUVAI[Variable=="Energy intensity" & Scenario=="EU1"], aes(x=Year, y=ByBL, colour=Study, group=Model), linetype=2 ) +
#
geom_hline(yintercept=100, linetype=2) +
facet_wrap(~Variable, ncol=1) +
coord_cartesian(xlim=c(2005:2050), ylim=c(0:150)) +
theme_bw() +
ggtitle("Compared to baseline") +
labs(y="Index (BL=100) ", x = "Year") +
guides(fill=guide_legend("Sector"))+
# scale_colour_manual(values=c("#4bbff2","#a5ae64"),
#                     breaks=c("EU1", "EU9"),
#                     labels = c("No policy baseline",
#                                "80% reduction by 2050 [optimistic]")) +
GROBTHEME
print(IEATOTDEMFUTbl)
# Plot graph: PER SECTOR IN TOTAL., NOTE IEA DATA IN KTOE.  1ktoe =~42PJ
IEATOTDEMFUTy2005=ggplot() +
# Removed: , "Value Added|Industry"
geom_line(data=EMF28meltEU.stand[Variable %in% c("Final Energy|Industry", "Emissions|CO2|||Industry") & Scenario %in% c("EU1")], aes(x=Year, y=ByY, colour=Study, group=Model), linetype=2 ) +
geom_line(data=EMF28meltEU.stand[Variable %in% c("Final Energy|Industry", "Emissions|CO2|||Industry") & Scenario %in% c("EU9")], aes(x=Year, y=ByY, colour=Study, group=Model), size=1 ) +
geom_hline(yintercept=100, linetype=2) +
geom_line(data=EIAETP2017[!Scenario=="BL"], aes(x=Year, y=ByY, colour=Study, group=Scenario), size=1 ) +
geom_line(data=EIAETP2017, aes(x=Year, y=ByX, colour=Study, group=Scenario), size=1, linetype=2 ) +
geom_line(data=ADAM[!Scenario=="BL"], aes(x=Year, y=ByY, colour=Study, group=Scenario), size=1 ) +
geom_line(data=ADAM, aes(x=Year, y=ByX, colour=Study, group=Scenario), size=1, linetype=2 ) +
geom_line(data=Fragosdatacalc[!Scenario=="BL"], aes(x=Year, y=ByY, colour=Study, group=Scenario), size=1 ) +
geom_line(data=Fragosdatacalc, aes(x=Year, y=ByX, colour=Study, group=Scenario), size=1, linetype=2 ) +
# #Emission intensity
# geom_line(data=EMF28meltEUEmeff[Scenario=="EU9"], aes(x=Year, y=ByY, colour=Study, group=Model), size=1 ) +
# geom_line(data=EMF28meltEUEmeff[Scenario=="EU1"], aes(x=Year, y=ByY, colour=Study, group=Model), linetype=2 ) +
#   geom_line(data=EIAETP2017emeff[!Scenario.x=="BL"], aes(x=Year, y=ByY, colour=Study, group=Scenario.x), size=1 ) +
# geom_line(data=EIAETP2017emeff[Scenario.x=="BL"], aes(x=Year, y=ByY, colour=Study, group=Scenario.x), linetype=2 ) +
#   geom_line(data=ADAMemeff[!Scenario.x=="BL"], aes(x=Year, y=ByY, colour=Study, group=Scenario.x), size=1 ) +
#   geom_line(data=ADAMemeff[Scenario.x=="BL"], aes(x=Year, y=ByY, colour=Study, group=Scenario.x), linetype=2 ) +
#
#  ### Energy intensity (Value added intensitt)
# geom_line(data=EMF28meltEUVAI[Variable=="Energy intensity" & Scenario=="EU9"], aes(x=Year, y=ByY, colour=Study, group=Model), size=1 ) +
# geom_line(data=EMF28meltEUVAI[Variable=="Energy intensity" & Scenario=="EU1"], aes(x=Year, y=ByY, colour=Study, group=Model), linetype=2 ) +
#
facet_wrap(~Variable, ncol=1) +
coord_cartesian(xlim=c(2005:2050), ylim=c(0:150)) +
theme_bw() +
ggtitle("Compared to base year") +
labs(y="Index (2015=100) ", x = "Year") +
guides(fill=guide_legend("Sector"))+
# scale_colour_manual(values=c("#4bbff2","#a5ae64"),
#                     breaks=c("EU1", "EU9"),
#                     labels = c("No policy baseline",
#                                "80% reduction by 2050 [optimistic]")) +
GROBTHEME
print(IEATOTDEMFUTy2005)
################# DUMMY DATA FOR LEGEND
SCENARIOLEGEND=data.table(
Year=c(2010,2020, 2010,2020),
Scenario=c("Baseline","Baseline", "Decarbonisation", "Decarbonisation"),
value=c(1,2,1,2))
### Energy intensity (E/$)
EMF28meltEU=data.table(EMF28meltEU)
EMF28meltEUVAI=merge(EMF28meltEU[Variable=="Final Energy|Industry"], EMF28meltEU[Variable=="Value Added|Industry", -c("Variable", "BL", "Y2005")], by=c("Model", "Scenario", "Region", "Year"))
head(EMF28meltEU)
#################
################################################################################
# Integrate with EMF28 models
## INSERT EU ROUNDTABLE COUNTRIES OF EMF28 MODELING
EMF280  = read.csv("../../EMF28/EMF28_data.csv", sep=",", dec=".")
EMF28melt= melt(EMF280, id.vars=c("model","Scenario", "Region","Variable", "Unit"), variable_name="Year")
EMF28melt$Year = as.numeric(substr(EMF28melt$Year, 2, stop=100))
EMF28melt$value = as.numeric(EMF28melt$value)
setnames(EMF28melt, "model", "Model")
EMF28melt=data.table(EMF28melt)
EMF28meltEU=EMF28melt[Region=="EU27"]
EMF28meltEUBL=EMF28meltEU[Scenario=="EU1"]
EMF28meltEUBL$Scenario <- NULL
setnames(EMF28meltEUBL, "value", "BL")
EMF28meltEUBLY=EMF28meltEU[Year=="2010"]
setnames(EMF28meltEUBLY, "value", "Y2005")
EMF28meltEUBLY$Year <- NULL
EMF28melt= melt(EMF280, id.vars=c("model","Scenario", "Region","Variable", "Unit"), variable.name="Year")
EMF28melt$Year = as.numeric(substr(EMF28melt$Year, 2, stop=100))
EMF28melt$value = as.numeric(EMF28melt$value)
setnames(EMF28melt, "model", "Model")
EMF28melt=data.table(EMF28melt)
EMF28meltEU=EMF28melt[Region=="EU27"]
EMF28meltEUBL=EMF28meltEU[Scenario=="EU1"]
EMF28meltEUBL$Scenario <- NULL
setnames(EMF28meltEUBL, "value", "BL")
EMF28meltEUBLY=EMF28meltEU[Year=="2010"]
setnames(EMF28meltEUBLY, "value", "Y2005")
EMF28meltEUBLY$Year <- NULL
EMF28meltEU=merge(EMF28meltEU, EMF28meltEUBL, by=c("Model", "Region", "Variable", "Unit", "Year"))
EMF28meltEU=merge(EMF28meltEU, EMF28meltEUBLY, by=c("Model", "Scenario", "Region", "Variable", "Unit"))
EMF28meltEU.stand=EMF28meltEU %>% mutate(ByBL=(value/BL)*100, ByY=(value/Y2005)*100)
EMF28meltEU.stand=data.table(EMF28meltEU.stand)
EMF28meltEU.stand$Variable <- gsub("|Fossil Fuels and industry|Energy Demand", "", EMF28meltEU.stand$Variable, fixed=FALSE)
EMF28meltEU.stand$Study <- "Förster et al. (2013)"
##
EMF28meltEU.minmaxBL=EMF28meltEU.stand[,list(ymax=max(ByBL,na.rm = TRUE),ymin=min(ByBL,na.rm = TRUE)),by=c("Scenario", "Variable", "Year", "Study")]
EMF28meltEU.minmaxY=EMF28meltEU.stand[,list(ymax=max(ByY,na.rm = TRUE),ymin=min(ByY,na.rm = TRUE)),by=c("Scenario", "Variable", "Year", "Study")]
#################
################################################################################
# Integrate with EMF28 models
## INSERT EU ROUNDTABLE COUNTRIES OF EMF28 MODELING
EMF280  = read.csv("../../EMF28/EMF28_data.csv", sep=",", dec=".")
EMF28melt= melt(EMF280, id.vars=c("model","Scenario", "Region","Variable", "Unit"), variable.name="Year")
EMF28melt$Year = as.numeric(substr(EMF28melt$Year, 2, stop=100))
EMF28melt$value = as.numeric(EMF28melt$value)
setnames(EMF28melt, "model", "Model")
EMF28melt=data.table(EMF28melt)
EMF28meltEU=EMF28melt[Region=="EU27"]
EMF28meltEUBL=EMF28meltEU[Scenario=="EU1"]
EMF28meltEUBL$Scenario <- NULL
setnames(EMF28meltEUBL, "value", "BL")
EMF28meltEUBLY=EMF28meltEU[Year=="2010"]
setnames(EMF28meltEUBLY, "value", "Y2005")
EMF28meltEUBLY$Year <- NULL
EMF28meltEU=merge(EMF28meltEU, EMF28meltEUBL, by=c("Model", "Region", "Variable", "Unit", "Year"))
EMF28meltEU=merge(EMF28meltEU, EMF28meltEUBLY, by=c("Model", "Scenario", "Region", "Variable", "Unit"))
EMF28meltEU.stand=EMF28meltEU %>% mutate(ByBL=(value/BL)*100, ByY=(value/Y2005)*100)
EMF28meltEU.stand=data.table(EMF28meltEU.stand)
EMF28meltEU.stand$Variable <- gsub("|Fossil Fuels and industry|Energy Demand", "", EMF28meltEU.stand$Variable, fixed=FALSE)
EMF28meltEU.stand$Study <- "Förster et al. (2013)"
##
EMF28meltEU.minmaxBL=EMF28meltEU.stand[,list(ymax=max(ByBL,na.rm = TRUE),ymin=min(ByBL,na.rm = TRUE)),by=c("Scenario", "Variable", "Year", "Study")]
EMF28meltEU.minmaxY=EMF28meltEU.stand[,list(ymax=max(ByY,na.rm = TRUE),ymin=min(ByY,na.rm = TRUE)),by=c("Scenario", "Variable", "Year", "Study")]
# IEA Energy Technology Perspectives 2017 (EU, CO2 emissions, MtCO2)
EIAETP2017ghg=data.table(
Year=c(	2014,	2025,	2030,	2035,	2040,	2045,	2050,	2055,	2060),
n2DS=c(	535.166435835586,	494.243229509687,	402.598311905768,	345.858566149151,	301.310149855724,	262.85707389194,	231.279854216602,	197.42903537661,	167.520926650679),
BL=c(	535.166435835586,	533.185107488493,	498.247226970959,	459.317685973749,	413.537508445583,	385.525348635476,	362.539840830355,	329.506642853231,	304.095658444859),
B2DS=c(	535.166435835586,	414.816202772753,	333.193958766128,	254.828917832113,	212.188349670598,	180.716638364295,	145.718337436352,	117.999763292729,	88.7911258076458)
)
EIAETP2017ghg$Variable <- "Emissions|CO2|||Industry" # in MtCO2
EIAETP2017tfec=data.table(
Year=c(	2014,	2025,	2030,	2035,	2040,	2045,	2050,	2055,	2060),
n2DS=c(	15719.4132806439,	15297.3166533884,	13949.7140490422,	12969.0889812852,	12350.7704481325,	11650.4610078419,	11202.8463892211,	11012.3219688063,	10826.1448938142),
BL=c(	15719.4132806439,	15550.6147880395,	14939.6110204016,	14265.5276270116,	13424.5816957318,	12923.0681629053,	12385.1827046389,	11937.9321132286,	11743.2708881713),
B2DS=c(	15719.3335363075,	14108.2463665606,	12850.8350492727,	11881.8686912442,	11320.9237556038,	10649.7089952085,	10520.2452541197,	10418.2897087513,	10249.6348231172))
EIAETP2017tfec$Variable <- "Final Energy|Industry"  # in PJ
EIAETP2017=rbind(EIAETP2017ghg, EIAETP2017tfec)
EIAETP2017=gather(EIAETP2017, Scenario, value, by=c("n2DS","B2DS"))
EIAETP2017=data.table(EIAETP2017)
EIAETP2017y2015=data.table(Variable=c("Emissions|CO2|||Industry", "Final Energy|Industry"),
Y2015=c(552, 15719))
EIAETP2017=merge(EIAETP2017, EIAETP2017y2015, by=c("Variable"))
EIAETP2017 = EIAETP2017 %>% mutate(ByBL=(value/BL)*100, ByY=(value/Y2015)*100, ByX=(BL/Y2015)*100)
EIAETP2017=data.table(EIAETP2017)
EIAETP2017$Study <- "OECD/IEA (2017b)"
## Emissions efficiency
###### ADAM (p. 231, final energy consumption for EU27 [in PJ])
ADAMtfec=data.table(
Year=c(2005,2020,2050),
BL=c(14012,12704, 9797),
n2DS =c(14012,11174, 6439),
B2DS=c(14012,11185, 6464)
)
ADAMtfec=gather(ADAMtfec, Scenario, value, by=c("n2DS", "B2DS", "BL"))
ADAMtfec$Variable <- "Final Energy|Industry"
ADAMghg=data.table(
Year=c(2005,2020,  2050),
BL=c(651.53,558.43, 349.94),
n2DS =c(651.53,509.57, 235.71),
B2DS=c(651.53,485.94, 209.99)
)
###### ADAM (p. 181, industrial CO2 emissions for EU27 [in Mt])
ADAMghg=gather(ADAMghg, Scenario, value, by=c("n2DS", "B2DS", "BL"))
ADAMghg$Variable <- "Emissions|CO2|||Industry"
ADAM=rbind(ADAMtfec,ADAMghg)
ADAM$Study <- "Schade et al. (2009)"
#Intrapolatie with approximate
ADAM.intrapolate=seq(unique(ADAM$Year)[1],2100) #unique(sdt$Year)[length(unique(sdt$Year))]
ADAM=data.table(ADAM)
ADAMinter = ADAM[,list(approx(x=Year,y=value,xout=ADAM.intrapolate)$y,approx(x=Year,y=value,xout=ADAM.intrapolate)$x),by=c('Scenario','Variable', 'Study')]
setnames(ADAMinter, "V1", "value")
setnames(ADAMinter, "V2", "Year")
ADAM=merge(ADAMinter[!Scenario=="BL"], ADAMinter[Scenario=="BL", -c('Scenario', 'Study')], by=c("Year", 'Variable'), allow.cartesian=TRUE)
setnames(ADAM, "value.x", "value")
setnames(ADAM, "value.y", "BL")
ADAMy=data.table(Variable=c("Emissions|CO2|||Industry", "Final Energy|Industry"),
Y2005=c(652, 14012)
)
ADAM=merge(ADAM, ADAMy, by=c("Variable"))
ADAM = ADAM %>% mutate(ByBL=(value/BL)*100, ByY=(value/Y2005)*100, ByX=(BL/Y2005)*100)
####### FRAGKOS et al. (2017)  # Had to calculate Energy with final energy and share of industry
Fragosdata=data.table(Scenario=c(	"BL",	"BL",	"BL",	"n2DS",	"n2DS",	"n2DS"),
Year=c(	2010,	2030,	2050,	2010,	2030,	2050),
Emissions=c(	520,	484,	425,	520,	453,	193),
Energy=c(	290.658,	307.398,	309.619,	290.658,	295.075,	251.908))
Fragosdata=gather(Fragosdata, Variable, value, c("Emissions", "Energy"))
Fragosdata=data.table(Fragosdata)
Fragosdata2010=data.table(Variable=c("Emissions", "Energy"),
Y2010=c(520,290.658))
Fragosdatacalc=merge(Fragosdata, Fragosdata2010, by=c("Variable"))
Fragosdatacalc=merge(Fragosdatacalc, Fragosdata[Scenario=="BL", -c("Scenario")], by=c("Year", "Variable"))
setnames(Fragosdatacalc, "value.x", "value")
setnames(Fragosdatacalc, "value.y", "BL")
Fragosdatacalc=Fragosdatacalc %>% mutate(ByY=(value/Y2010)*100, ByBL=(value/BL)*100, ByX=(BL/Y2010)*100)
Fragosdatacalc$Study <- "Fragkos et al. (2017)"
Fragosdatacalc=data.table(Fragosdatacalc)
Fragosdatacalc=Fragosdatacalc[Variable=="Energy", Variable:=("Final Energy|Industry")]
Fragosdatacalc=Fragosdatacalc[Variable=="Emissions", Variable:=("Emissions|CO2|||Industry")]
#################################################################################
# Emissions efficiency = G/E  (Mtonne/PJ)
EMF28meltEUEmeff=EMF28meltEU.stand[Variable %in% c("Final Energy|Industry", "Emissions|CO2|||Industry"), -c("Unit","BL", "ByBL", "ByY", "Y2005")]
EMF28meltEUEmeff=spread(EMF28meltEUEmeff, Variable, value)
setnames(EMF28meltEUEmeff, "Final Energy|Industry", "TFEC")
setnames(EMF28meltEUEmeff, "Emissions|CO2|||Industry", "GHG")
EMF28meltEUEmeff=EMF28meltEUEmeff %>% mutate(Index=(GHG/TFEC))
EMF28meltEUEmeff=data.table(EMF28meltEUEmeff)
EMF28meltEUEmeffBL=EMF28meltEUEmeff[Scenario=="EU1"]
EMF28meltEUEmeff2015=EMF28meltEUEmeff[Year=="2015"]
EMF28meltEUEmeff=merge(EMF28meltEUEmeff, EMF28meltEUEmeffBL[, c("Model", "Year", "Index")], by=c("Model", "Year"))
EMF28meltEUEmeff=merge(EMF28meltEUEmeff, EMF28meltEUEmeff2015[, c("Model", "Scenario", "Index")], by=c("Model", "Scenario"))
EMF28meltEUEmeff=EMF28meltEUEmeff %>% mutate(ByBL=(Index.x/Index.y)*100, ByY=(Index.x/Index)*100)
EMF28meltEUEmeff=data.table(EMF28meltEUEmeff)
EMF28meltEUEmeff$Study <- "Förster et al. (2013)"
EMF28meltEUEmeff$Variable <- "Emissions intensity"
#ADAMemeff=merge(ADAMghg, ADAMtfec, by=c("Year", "Scenario"))
ADAM=data.table(ADAM)
ADAMemeff=merge(ADAM[Variable=="Emissions|CO2|||Industry"], ADAM[Variable=="Final Energy|Industry"], by=c("Year", "Scenario", "Study"))
ADAMemeff=ADAMemeff %>% mutate(BLemeff=((BL.x*1000)/BL.y), B2DSemeff=((value.x*1000)/value.y))  #Makes kgram/J)
ADAMemeff=gather(ADAMemeff, Emeff, value, by=c("BLemeff", "B2DSemeff"))
ADAMemeff=ADAMemeff[,c("Year", "Scenario", "Study", "Emeff", "value")]
ADAMemeff$Variable <- "Emissions intensity"
ADAMemeff$Study <- "Schade et al. (2009)"
ADAMemeff=data.table(ADAMemeff)
ADAMemeff=ADAMemeff[Emeff=="BLemeff", Scenario:=c("BL")]
ADAMemeff=unique(ADAMemeff)
ADAMemeff=merge(ADAMemeff, ADAMemeff[Scenario=="BL"], by=c("Year","Variable", "Study"),allow.cartesian=TRUE)
ADAMemeff$Y2005 <- 46.49800
ADAMemeff=ADAMemeff %>% mutate(ByBL=(value.x/value.y)*100, ByY=(value.x/Y2005)*100)
ADAMemeff=data.table(ADAMemeff)
#Fragkos et al. (2017)
FRAGKOSemeff=merge(Fragosdatacalc[Variable=="Emissions|CO2|||Industry"], Fragosdatacalc[Variable=="Final Energy|Industry"], by=c("Year", "Scenario", "Study"))
FRAGKOSemeff=FRAGKOSemeff %>% mutate(BLemeff=((BL.x)/BL.y*41.87), B2DSemeff=((value.x)/value.y*41.87))  #MtonCO2/Mtoe #Makes kgram/ kJ (???)
FRAGKOSemeff=gather(FRAGKOSemeff, Emeff, value, by=c("BLemeff", "B2DSemeff"))
FRAGKOSemeff=FRAGKOSemeff[,c("Year", "Scenario", "Study", "Emeff", "value")]
FRAGKOSemeff$Variable <- "Emissions intensity"
FRAGKOSemeff$Study <- "Frqagkos et al. (2017)"
FRAGKOSemeff=data.table(FRAGKOSemeff)
FRAGKOSemeff=FRAGKOSemeff[Emeff=="BLemeff", Scenario:=c("BL")]
FRAGKOSemeff=unique(FRAGKOSemeff)
FRAGKOSemeff=merge(FRAGKOSemeff, FRAGKOSemeff[Scenario=="BL"], by=c("Year","Variable", "Study", "Emeff"),allow.cartesian=TRUE)
setnames(FRAGKOSemeff,"value.y", "BL")
FRAGKOSemeff=data.table(FRAGKOSemeff)
FRAGKOSemeff$Y2010 <- 75
FRAGKOSemeff=FRAGKOSemeff %>% mutate(ByBL=(value.x/BL)*100, ByY=(value.x/Y2010)*100)
FRAGKOSemeff=data.table(FRAGKOSemeff)
#
#IEA
EIAETP2017emeff=rbind(EIAETP2017ghg, EIAETP2017tfec)
EIAETP2017emeff=gather(EIAETP2017emeff, Scenario, value, by=c("n2DS", "BL", "B2DS"))
EIAETP2017emeff=spread(EIAETP2017emeff, Variable, value)
setnames(EIAETP2017emeff, "Final Energy|Industry", "TFEC") # in EJ/yr
setnames(EIAETP2017emeff, "Emissions|CO2|||Industry", "GHG")  # Mt CO2/yr
EIAETP2017emeff=EIAETP2017emeff %>% mutate(Emeff=((GHG*1000)/TFEC))
EIAETP2017emeff$Variable  <- "Emissions intensity"
EIAETP2017emeff$Study <- "OECD/IEA (2017b)"
EIAETP2017emeff=data.table(EIAETP2017emeff)
EIAETP2017emeff=merge(EIAETP2017emeff, EIAETP2017emeff[Scenario=="BL", -c("TFEC","GHG")], by=c("Year", "Variable", "Study"))
EIAETP2017emeff$Y2014 <- 35.10810
EIAETP2017emeff=EIAETP2017emeff %>% mutate(ByBL=(Emeff.x/Emeff.y)*100, ByY=(Emeff.x/Y2014)*100)
EIAETP2017emeff=data.table(EIAETP2017emeff)
### Energy intensity (E/$)
EMF28meltEU=data.table(EMF28meltEU)
EMF28meltEUVAI=merge(EMF28meltEU[Variable=="Final Energy|Industry"], EMF28meltEU[Variable=="Value Added|Industry", -c("Variable", "BL", "Y2005")], by=c("Model", "Scenario", "Region", "Year"))
setnames(EMF28meltEUVAI, "value.y", "VA")
EMF28meltEUVAI=EMF28meltEUVAI %>% mutate(VAI=((value.x/VA)))
EMF28meltEUVAI=data.table(EMF28meltEUVAI)
EMF28meltEUVAI=merge(EMF28meltEUVAI, EMF28meltEUVAI[Scenario=="EU11", -c("Scenario",  "Y2005", "BL", "value.x", "VA", "Unit.x", "Unit.y", "Variable.x", "Variable.y")], by=c("Model", "Year", "Region"))
setnames(EMF28meltEUVAI, "VAI.y", "BLvai")
EMF28meltEUVAI=merge(EMF28meltEUVAI, EMF28meltEUVAI[Year=="2010", -c("Year",  "Y2005", "BL", "value.x", "VA", "BLvai", "Unit.x", "Unit.y", "Variable.x", "Variable.y")], by=c("Model", "Scenario", "Region"))
setnames(EMF28meltEUVAI, "VAI.x.y", "Y2010vai")
setnames(EMF28meltEUVAI, "VAI.x.x", "VAI")
EMF28meltEUVAI=EMF28meltEUVAI %>% mutate(ByBL=((VAI/BLvai)*100), ByY=((VAI/Y2010vai)*100))
EMF28meltEUVAI=data.table(EMF28meltEUVAI)
EMF28meltEUVAI$Study <- "Förster et al. (2013)"
EMF28meltEUVAI=EMF28meltEUVAI[Variable.x=="Final Energy|Industry",Variable.x:=("Energy intensity")]
setnames(EMF28meltEUVAI, "Variable.x", "Variable")
###############
#################
################################################################################
# Integrate with EMF28 models
## INSERT EU ROUNDTABLE COUNTRIES OF EMF28 MODELING
EMF280  = read.csv("../../EMF28/EMF28_data.csv", sep=",", dec=".")
EMF28melt= melt(EMF280, id.vars=c("model","Scenario", "Region","Variable", "Unit"), variable.name="Year")
EMF28melt$Year = as.numeric(substr(EMF28melt$Year, 2, stop=100))
EMF28melt$value = as.numeric(EMF28melt$value)
setnames(EMF28melt, "model", "Model")
EMF28melt=data.table(EMF28melt)
EMF28meltEU=EMF28melt[Region=="EU27"]
EMF28meltEUBL=EMF28meltEU[Scenario=="EU1"]
EMF28meltEUBL$Scenario <- NULL
setnames(EMF28meltEUBL, "value", "BL")
EMF28meltEUBLY=EMF28meltEU[Year=="2010"]
setnames(EMF28meltEUBLY, "value", "Y2005")
EMF28meltEUBLY$Year <- NULL
EMF28meltEU=merge(EMF28meltEU, EMF28meltEUBL, by=c("Model", "Region", "Variable", "Unit", "Year"))
EMF28meltEU=merge(EMF28meltEU, EMF28meltEUBLY, by=c("Model", "Scenario", "Region", "Variable", "Unit"))
EMF28meltEU.stand=EMF28meltEU %>% mutate(ByBL=(value/BL)*100, ByY=(value/Y2005)*100)
EMF28meltEU.stand=data.table(EMF28meltEU.stand)
EMF28meltEU.stand$Variable <- gsub("|Fossil Fuels and industry|Energy Demand", "", EMF28meltEU.stand$Variable, fixed=FALSE)
EMF28meltEU.stand$Study <- "Förster et al. (2013)"
##
EMF28meltEU.minmaxBL=EMF28meltEU.stand[,list(ymax=max(ByBL,na.rm = TRUE),ymin=min(ByBL,na.rm = TRUE)),by=c("Scenario", "Variable", "Year", "Study")]
EMF28meltEU.minmaxY=EMF28meltEU.stand[,list(ymax=max(ByY,na.rm = TRUE),ymin=min(ByY,na.rm = TRUE)),by=c("Scenario", "Variable", "Year", "Study")]
# IEA Energy Technology Perspectives 2017 (EU, CO2 emissions, MtCO2)
EIAETP2017ghg=data.table(
Year=c(	2014,	2025,	2030,	2035,	2040,	2045,	2050,	2055,	2060),
n2DS=c(	535.166435835586,	494.243229509687,	402.598311905768,	345.858566149151,	301.310149855724,	262.85707389194,	231.279854216602,	197.42903537661,	167.520926650679),
BL=c(	535.166435835586,	533.185107488493,	498.247226970959,	459.317685973749,	413.537508445583,	385.525348635476,	362.539840830355,	329.506642853231,	304.095658444859),
B2DS=c(	535.166435835586,	414.816202772753,	333.193958766128,	254.828917832113,	212.188349670598,	180.716638364295,	145.718337436352,	117.999763292729,	88.7911258076458)
)
EIAETP2017ghg$Variable <- "Emissions|CO2|||Industry" # in MtCO2
EIAETP2017tfec=data.table(
Year=c(	2014,	2025,	2030,	2035,	2040,	2045,	2050,	2055,	2060),
n2DS=c(	15719.4132806439,	15297.3166533884,	13949.7140490422,	12969.0889812852,	12350.7704481325,	11650.4610078419,	11202.8463892211,	11012.3219688063,	10826.1448938142),
BL=c(	15719.4132806439,	15550.6147880395,	14939.6110204016,	14265.5276270116,	13424.5816957318,	12923.0681629053,	12385.1827046389,	11937.9321132286,	11743.2708881713),
B2DS=c(	15719.3335363075,	14108.2463665606,	12850.8350492727,	11881.8686912442,	11320.9237556038,	10649.7089952085,	10520.2452541197,	10418.2897087513,	10249.6348231172))
EIAETP2017tfec$Variable <- "Final Energy|Industry"  # in PJ
EIAETP2017=rbind(EIAETP2017ghg, EIAETP2017tfec)
EIAETP2017=gather(EIAETP2017, Scenario, value, by=c("n2DS","B2DS"))
EIAETP2017=data.table(EIAETP2017)
EIAETP2017y2015=data.table(Variable=c("Emissions|CO2|||Industry", "Final Energy|Industry"),
Y2015=c(552, 15719))
EIAETP2017=merge(EIAETP2017, EIAETP2017y2015, by=c("Variable"))
EIAETP2017 = EIAETP2017 %>% mutate(ByBL=(value/BL)*100, ByY=(value/Y2015)*100, ByX=(BL/Y2015)*100)
EIAETP2017=data.table(EIAETP2017)
EIAETP2017$Study <- "OECD/IEA (2017b)"
## Emissions efficiency
###### ADAM (p. 231, final energy consumption for EU27 [in PJ])
ADAMtfec=data.table(
Year=c(2005,2020,2050),
BL=c(14012,12704, 9797),
n2DS =c(14012,11174, 6439),
B2DS=c(14012,11185, 6464)
)
ADAMtfec=gather(ADAMtfec, Scenario, value, by=c("n2DS", "B2DS", "BL"))
ADAMtfec$Variable <- "Final Energy|Industry"
ADAMghg=data.table(
Year=c(2005,2020,  2050),
BL=c(651.53,558.43, 349.94),
n2DS =c(651.53,509.57, 235.71),
B2DS=c(651.53,485.94, 209.99)
)
###### ADAM (p. 181, industrial CO2 emissions for EU27 [in Mt])
ADAMghg=gather(ADAMghg, Scenario, value, by=c("n2DS", "B2DS", "BL"))
ADAMghg$Variable <- "Emissions|CO2|||Industry"
ADAM=rbind(ADAMtfec,ADAMghg)
ADAM$Study <- "Schade et al. (2009)"
#Intrapolatie with approximate
ADAM.intrapolate=seq(unique(ADAM$Year)[1],2100) #unique(sdt$Year)[length(unique(sdt$Year))]
ADAM=data.table(ADAM)
ADAMinter = ADAM[,list(approx(x=Year,y=value,xout=ADAM.intrapolate)$y,approx(x=Year,y=value,xout=ADAM.intrapolate)$x),by=c('Scenario','Variable', 'Study')]
setnames(ADAMinter, "V1", "value")
setnames(ADAMinter, "V2", "Year")
ADAM=merge(ADAMinter[!Scenario=="BL"], ADAMinter[Scenario=="BL", -c('Scenario', 'Study')], by=c("Year", 'Variable'), allow.cartesian=TRUE)
setnames(ADAM, "value.x", "value")
setnames(ADAM, "value.y", "BL")
ADAMy=data.table(Variable=c("Emissions|CO2|||Industry", "Final Energy|Industry"),
Y2005=c(652, 14012)
)
ADAM=merge(ADAM, ADAMy, by=c("Variable"))
ADAM = ADAM %>% mutate(ByBL=(value/BL)*100, ByY=(value/Y2005)*100, ByX=(BL/Y2005)*100)
####### FRAGKOS et al. (2017)  # Had to calculate Energy with final energy and share of industry
Fragosdata=data.table(Scenario=c(	"BL",	"BL",	"BL",	"n2DS",	"n2DS",	"n2DS"),
Year=c(	2010,	2030,	2050,	2010,	2030,	2050),
Emissions=c(	520,	484,	425,	520,	453,	193),
Energy=c(	290.658,	307.398,	309.619,	290.658,	295.075,	251.908))
Fragosdata=gather(Fragosdata, Variable, value, c("Emissions", "Energy"))
Fragosdata=data.table(Fragosdata)
Fragosdata2010=data.table(Variable=c("Emissions", "Energy"),
Y2010=c(520,290.658))
Fragosdatacalc=merge(Fragosdata, Fragosdata2010, by=c("Variable"))
Fragosdatacalc=merge(Fragosdatacalc, Fragosdata[Scenario=="BL", -c("Scenario")], by=c("Year", "Variable"))
setnames(Fragosdatacalc, "value.x", "value")
setnames(Fragosdatacalc, "value.y", "BL")
Fragosdatacalc=Fragosdatacalc %>% mutate(ByY=(value/Y2010)*100, ByBL=(value/BL)*100, ByX=(BL/Y2010)*100)
Fragosdatacalc$Study <- "Fragkos et al. (2017)"
Fragosdatacalc=data.table(Fragosdatacalc)
Fragosdatacalc=Fragosdatacalc[Variable=="Energy", Variable:=("Final Energy|Industry")]
Fragosdatacalc=Fragosdatacalc[Variable=="Emissions", Variable:=("Emissions|CO2|||Industry")]
#################################################################################
# Emissions efficiency = G/E  (Mtonne/PJ)
EMF28meltEUEmeff=EMF28meltEU.stand[Variable %in% c("Final Energy|Industry", "Emissions|CO2|||Industry"), -c("Unit","BL", "ByBL", "ByY", "Y2005")]
EMF28meltEUEmeff=spread(EMF28meltEUEmeff, Variable, value)
setnames(EMF28meltEUEmeff, "Final Energy|Industry", "TFEC")
setnames(EMF28meltEUEmeff, "Emissions|CO2|||Industry", "GHG")
EMF28meltEUEmeff=EMF28meltEUEmeff %>% mutate(Index=(GHG/TFEC))
EMF28meltEUEmeff=data.table(EMF28meltEUEmeff)
EMF28meltEUEmeffBL=EMF28meltEUEmeff[Scenario=="EU1"]
EMF28meltEUEmeff2015=EMF28meltEUEmeff[Year=="2015"]
EMF28meltEUEmeff=merge(EMF28meltEUEmeff, EMF28meltEUEmeffBL[, c("Model", "Year", "Index")], by=c("Model", "Year"))
EMF28meltEUEmeff=merge(EMF28meltEUEmeff, EMF28meltEUEmeff2015[, c("Model", "Scenario", "Index")], by=c("Model", "Scenario"))
EMF28meltEUEmeff=EMF28meltEUEmeff %>% mutate(ByBL=(Index.x/Index.y)*100, ByY=(Index.x/Index)*100)
EMF28meltEUEmeff=data.table(EMF28meltEUEmeff)
EMF28meltEUEmeff$Study <- "Förster et al. (2013)"
EMF28meltEUEmeff$Variable <- "Emissions intensity"
#ADAMemeff=merge(ADAMghg, ADAMtfec, by=c("Year", "Scenario"))
ADAM=data.table(ADAM)
ADAMemeff=merge(ADAM[Variable=="Emissions|CO2|||Industry"], ADAM[Variable=="Final Energy|Industry"], by=c("Year", "Scenario", "Study"))
ADAMemeff=ADAMemeff %>% mutate(BLemeff=((BL.x*1000)/BL.y), B2DSemeff=((value.x*1000)/value.y))  #Makes kgram/J)
ADAMemeff=gather(ADAMemeff, Emeff, value, by=c("BLemeff", "B2DSemeff"))
ADAMemeff=ADAMemeff[,c("Year", "Scenario", "Study", "Emeff", "value")]
ADAMemeff$Variable <- "Emissions intensity"
ADAMemeff$Study <- "Schade et al. (2009)"
ADAMemeff=data.table(ADAMemeff)
ADAMemeff=ADAMemeff[Emeff=="BLemeff", Scenario:=c("BL")]
ADAMemeff=unique(ADAMemeff)
ADAMemeff=merge(ADAMemeff, ADAMemeff[Scenario=="BL"], by=c("Year","Variable", "Study"),allow.cartesian=TRUE)
ADAMemeff$Y2005 <- 46.49800
ADAMemeff=ADAMemeff %>% mutate(ByBL=(value.x/value.y)*100, ByY=(value.x/Y2005)*100)
ADAMemeff=data.table(ADAMemeff)
#Fragkos et al. (2017)
FRAGKOSemeff=merge(Fragosdatacalc[Variable=="Emissions|CO2|||Industry"], Fragosdatacalc[Variable=="Final Energy|Industry"], by=c("Year", "Scenario", "Study"))
FRAGKOSemeff=FRAGKOSemeff %>% mutate(BLemeff=((BL.x)/BL.y*41.87), B2DSemeff=((value.x)/value.y*41.87))  #MtonCO2/Mtoe #Makes kgram/ kJ (???)
FRAGKOSemeff=gather(FRAGKOSemeff, Emeff, value, by=c("BLemeff", "B2DSemeff"))
FRAGKOSemeff=FRAGKOSemeff[,c("Year", "Scenario", "Study", "Emeff", "value")]
FRAGKOSemeff$Variable <- "Emissions intensity"
FRAGKOSemeff$Study <- "Frqagkos et al. (2017)"
FRAGKOSemeff=data.table(FRAGKOSemeff)
FRAGKOSemeff=FRAGKOSemeff[Emeff=="BLemeff", Scenario:=c("BL")]
FRAGKOSemeff=unique(FRAGKOSemeff)
FRAGKOSemeff=merge(FRAGKOSemeff, FRAGKOSemeff[Scenario=="BL"], by=c("Year","Variable", "Study", "Emeff"),allow.cartesian=TRUE)
setnames(FRAGKOSemeff,"value.y", "BL")
FRAGKOSemeff=data.table(FRAGKOSemeff)
FRAGKOSemeff$Y2010 <- 75
FRAGKOSemeff=FRAGKOSemeff %>% mutate(ByBL=(value.x/BL)*100, ByY=(value.x/Y2010)*100)
FRAGKOSemeff=data.table(FRAGKOSemeff)
#
#IEA
EIAETP2017emeff=rbind(EIAETP2017ghg, EIAETP2017tfec)
EIAETP2017emeff=gather(EIAETP2017emeff, Scenario, value, by=c("n2DS", "BL", "B2DS"))
EIAETP2017emeff=spread(EIAETP2017emeff, Variable, value)
setnames(EIAETP2017emeff, "Final Energy|Industry", "TFEC") # in EJ/yr
setnames(EIAETP2017emeff, "Emissions|CO2|||Industry", "GHG")  # Mt CO2/yr
EIAETP2017emeff=EIAETP2017emeff %>% mutate(Emeff=((GHG*1000)/TFEC))
EIAETP2017emeff$Variable  <- "Emissions intensity"
EIAETP2017emeff$Study <- "OECD/IEA (2017b)"
EIAETP2017emeff=data.table(EIAETP2017emeff)
EIAETP2017emeff=merge(EIAETP2017emeff, EIAETP2017emeff[Scenario=="BL", -c("TFEC","GHG")], by=c("Year", "Variable", "Study"))
EIAETP2017emeff$Y2014 <- 35.10810
EIAETP2017emeff=EIAETP2017emeff %>% mutate(ByBL=(Emeff.x/Emeff.y)*100, ByY=(Emeff.x/Y2014)*100)
EIAETP2017emeff=data.table(EIAETP2017emeff)
### Energy intensity (E/$)
EMF28meltEU=data.table(EMF28meltEU)
EMF28meltEUVAI=merge(EMF28meltEU[Variable=="Final Energy|Industry"], EMF28meltEU[Variable=="Value Added|Industry", -c("Variable", "BL", "Y2005")], by=c("Model", "Scenario", "Region", "Year"))
setnames(EMF28meltEUVAI, "value.y", "VA")
EMF28meltEUVAI=EMF28meltEUVAI %>% mutate(VAI=((value.x/VA)))
EMF28meltEUVAI=data.table(EMF28meltEUVAI)
EMF28meltEUVAI=merge(EMF28meltEUVAI, EMF28meltEUVAI[Scenario=="EU11", -c("Scenario",  "Y2005", "BL", "value.x", "VA", "Unit.x", "Unit.y", "Variable.x", "Variable.y")], by=c("Model", "Year", "Region"))
setnames(EMF28meltEUVAI, "VAI.y", "BLvai")
EMF28meltEUVAI=merge(EMF28meltEUVAI, EMF28meltEUVAI[Year=="2010", -c("Year",  "Y2005", "BL", "value.x", "VA", "BLvai", "Unit.x", "Unit.y", "Variable.x", "Variable.y")], by=c("Model", "Scenario", "Region"))
setnames(EMF28meltEUVAI, "VAI.x.y", "Y2010vai")
setnames(EMF28meltEUVAI, "VAI.x.x", "VAI")
EMF28meltEUVAI=EMF28meltEUVAI %>% mutate(ByBL=((VAI/BLvai)*100), ByY=((VAI/Y2010vai)*100))
EMF28meltEUVAI=data.table(EMF28meltEUVAI)
EMF28meltEUVAI$Study <- "Förster et al. (2013)"
EMF28meltEUVAI=EMF28meltEUVAI[Variable.x=="Final Energy|Industry",Variable.x:=("Energy intensity")]
setnames(EMF28meltEUVAI, "Variable.x", "Variable")
###############
EMF28meltEU.stand=na.omit(EMF28meltEU.stand)
# Plot graph: PER SECTOR IN TOTAL., NOTE IEA DATA IN KTOE.  1ktoe =~42PJ
IEATOTDEMFUTbl=ggplot() +
#Removed , "Value Added|Industry"
geom_line(data=EMF28meltEU.stand[Variable %in% c("Final Energy|Industry", "Emissions|CO2|||Industry") & Scenario %in% c("EU1")], aes(x=Year, y=ByBL, colour=Study, group=Model), linetype=2 ) +
geom_line(data=EMF28meltEU.stand[Variable %in% c("Final Energy|Industry", "Emissions|CO2|||Industry") & Scenario %in% c("EU9")], aes(x=Year, y=ByBL, colour=Study, group=Model), size=1  ) +
geom_line(data=EIAETP2017, aes(x=Year, y=ByBL, colour=Study, group=Scenario), size=1 ) +
geom_line(data=ADAM, aes(x=Year, y=ByBL, colour=Study, group=Scenario), size=1 ) +
geom_line(data=Fragosdatacalc, aes(x=Year, y=ByBL, colour=Study, group=Scenario), size=1 ) +
#  # EMission intensity
#  geom_line(data=EMF28meltEUEmeff[Scenario=="EU9"], aes(x=Year, y=ByBL, colour=Study, group=Model), size=1 ) +
#  geom_line(data=EMF28meltEUEmeff[Scenario=="EU1"], aes(x=Year, y=ByBL, colour=Study, group=Model), linetype=2 ) +
# geom_line(data=EIAETP2017emeff[!Scenario.x=="BL"], aes(x=Year, y=ByBL, colour=Study, group=Scenario.x), size=1 ) +
# geom_line(data=EIAETP2017emeff[Scenario.x=="BL"], aes(x=Year, y=ByBL, colour=Study, group=Scenario.x), linetype=2 ) +
#  geom_line(data=ADAMemeff[!Scenario.x=="BL"], aes(x=Year, y=ByBL, colour=Study, group=Scenario.x), size=1 ) +
#  geom_line(data=ADAMemeff[Scenario.x=="BL"], aes(x=Year, y=ByBL, colour=Study, group=Scenario.x), linetype=2 ) +
#
#  ### Energy intensity (Value added intensitt)
#  geom_line(data=EMF28meltEUVAI[Variable=="Energy intensity" & Scenario=="EU9"], aes(x=Year, y=ByBL, colour=Study, group=Model), size=1 ) +
#  geom_line(data=EMF28meltEUVAI[Variable=="Energy intensity" & Scenario=="EU1"], aes(x=Year, y=ByBL, colour=Study, group=Model), linetype=2 ) +
#
geom_hline(yintercept=100, linetype=2) +
facet_wrap(~Variable, ncol=1) +
coord_cartesian(xlim=c(2005:2050), ylim=c(0:150)) +
theme_bw() +
ggtitle("Compared to baseline") +
labs(y="Index (BL=100) ", x = "Year") +
guides(fill=guide_legend("Sector"))+
# scale_colour_manual(values=c("#4bbff2","#a5ae64"),
#                     breaks=c("EU1", "EU9"),
#                     labels = c("No policy baseline",
#                                "80% reduction by 2050 [optimistic]")) +
GROBTHEME
print(IEATOTDEMFUTbl)
print(IEATOTDEMFUTbl)
