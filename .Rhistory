theme(legend.position="right",
legend.key = element_rect(colour="white"))
print(CEMISanim)
CEMIS
CEMISanim=ggplot()+
#geom_bar(data=fakeydata, aes(x=Region, y=value, fill=Variable), stat="identity", position="stack")+
geom_bar(data=CEMIS[Variable %in% c("Biomass|Industry","Fossil|Industry") & Region %in% c("EU28")], aes(x=Scenario, y=-CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
annotate("rect", xmin=-Inf,xmax=Inf,ymin=0,ymax=Inf, fill="lightgrey") +
annotate("rect", xmin=-Inf,xmax=Inf,ymin=-Inf,ymax=0, fill="lightblue") +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8, y=-25, label="CO[2]~Captured", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=0) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8, y=100, label="CO[2]~emitted", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=1) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
# # "Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing"
geom_bar(data=CEMIS[Variable %in% c("Biomass|Industry") & Region %in% c("EU28") ], aes(x=Scenario, y=CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMIS[Variable %in% c("Industry") & Region %in% c("EU28")], aes(x=Scenario, y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMIS[Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", " Cement") &  Region %in% c("EU28")], aes(x=Scenario, y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Gt"~CO[2])) + ggtitle(bquote(bold("Cumulative"~CO[2]~"emissions since 2018"))) +
coord_flip()+
GROBTHEME +
guides(fill=guide_legend( title="Emissions source",ncol=2, title.position="top", title.hjust = 0.5, override.aes=list(colour=NA))) +
theme(legend.position="right",
legend.key = element_rect(colour="white"))
print(CEMISanim)
CEMISanim=ggplot()+
#geom_bar(data=fakeydata, aes(x=Region, y=value, fill=Variable), stat="identity", position="stack")+
geom_bar(data=CEMIS[Variable %in% c("Biomass|Industry","Fossil|Industry") & Region %in% c("EU28")], aes(x=Scenario, y=-CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
annotate("rect", xmin=-Inf,xmax=Inf,ymin=0,ymax=Inf, fill="lightgrey") +
annotate("rect", xmin=-Inf,xmax=Inf,ymin=-Inf,ymax=0, fill="lightblue") +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8, y=-25, label="CO[2]~Captured", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=0) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8, y=100, label="CO[2]~emitted", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=1) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
# # "Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing"
geom_bar(data=CEMIS[Variable %in% c("Biomass|Industry") & Region %in% c("EU28") ], aes(x=Scenario, y=CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMIS[Variable %in% c("Industry") & Region %in% c("EU28")], aes(x=Scenario, y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMIS[Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", " Cement") &  Region %in% c("EU28")], aes(x=Scenario, y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Gt"~CO[2])) + ggtitle(bquote(bold("Cumulative"~CO[2]~"emissions since 2018"))) +
coord_flip()+
GROBTHEME +
guides(fill=guide_legend( title="Emissions source",ncol=2, title.position="top", title.hjust = 0.5, override.aes=list(colour=NA))) +
theme(legend.position="right",
legend.key = element_rect(colour="white")) +
transition_components(Year) +
exit_reset() +
labs(title = 'Year: {substr(frame_time, 1,4)} \n Final Energy Use per Carrier')
CEMISanim
CEMISanim=ggplot()+
#geom_bar(data=fakeydata, aes(x=Region, y=value, fill=Variable), stat="identity", position="stack")+
geom_bar(data=CEMIS[Variable %in% c("Biomass|Industry","Fossil|Industry") & Region %in% c("EU28")], aes(x=Scenario, y=-CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
annotate("rect", xmin=-Inf,xmax=Inf,ymin=0,ymax=Inf, fill="lightgrey") +
annotate("rect", xmin=-Inf,xmax=Inf,ymin=-Inf,ymax=0, fill="lightblue") +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8, y=-25, label="CO[2]~Captured", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=0) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8, y=100, label="CO[2]~emitted", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=1) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
# # "Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing"
geom_bar(data=CEMIS[Variable %in% c("Biomass|Industry") & Region %in% c("EU28") ], aes(x=Scenario, y=CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMIS[Variable %in% c("Industry") & Region %in% c("EU28")], aes(x=Scenario, y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMIS[Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", " Cement") &  Region %in% c("EU28")], aes(x=Scenario, y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Gt"~CO[2])) + ggtitle(bquote(bold("Cumulative"~CO[2]~"emissions since 2018"))) +
coord_flip()+
theme(
axis.text.x = element_text(angle = 45, size=12,  hjust=1),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
axis.text.y = element_text(size=12),
strip.text.x = element_text(size=12, face="bold"),
strip.text.y = element_text(size=12, face="bold"),
legend.text= element_text(size=12),
legend.title=element_text(size=13,  face="bold"),
plot.title=element_text(size=16, hjust=0.5, face="bold"),
plot.subtitle=element_text(size=14,hjust=0.5),
panel.border = element_rect(colour = "black", size=1),
legend.key =  element_rect(fill = 'white', size = 0.5),
strip.background = element_rect(colour="white", fill="#FFFFFF")
) +
guides(fill=guide_legend( title="Emissions source",ncol=2, title.position="top", title.hjust = 0.5, override.aes=list(colour=NA))) +
theme(
legend.key = element_rect(colour="white")) +
transition_components(Year) +
exit_reset() +
labs(title = 'Year: {substr(frame_time, 1,4)} \n Final Energy Use per Carrier')
CEMISanim
CEMISanim=ggplot()+
#geom_bar(data=fakeydata, aes(x=Region, y=value, fill=Variable), stat="identity", position="stack")+
geom_bar(data=CEMIS[Variable %in% c("Biomass|Industry","Fossil|Industry") & Region %in% c("EU28")], aes(x=Scenario, y=-CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
annotate("rect", xmin=-Inf,xmax=Inf,ymin=0,ymax=Inf, fill="lightgrey") +
annotate("rect", xmin=-Inf,xmax=Inf,ymin=-Inf,ymax=0, fill="lightblue") +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8, y=-25, label="CO[2]~Captured", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=0) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8, y=100, label="CO[2]~emitted", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=1) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
# # "Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing"
geom_bar(data=CEMIS[Variable %in% c("Biomass|Industry") & Region %in% c("EU28") ], aes(x=Scenario, y=CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMIS[Variable %in% c("Industry") & Region %in% c("EU28")], aes(x=Scenario, y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMIS[Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", " Cement") &  Region %in% c("EU28")], aes(x=Scenario, y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Gt"~CO[2])) + ggtitle(bquote(bold("Cumulative"~CO[2]~"emissions since 2018"))) +
coord_flip()+
theme(
axis.text.x = element_text(angle = 45, size=12,  hjust=1),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
axis.text.y = element_text(size=12),
strip.text.x = element_text(size=12, face="bold"),
strip.text.y = element_text(size=12, face="bold"),
legend.text= element_text(size=12),
legend.title=element_text(size=13,  face="bold"),
plot.title=element_text(size=16, hjust=0.5, face="bold"),
plot.subtitle=element_text(size=14,hjust=0.5),
panel.border = element_rect(colour = "black", size=1),
legend.key =  element_rect(fill = 'white', size = 0.5),
strip.background = element_rect(colour="white", fill="#FFFFFF")
) +
guides(fill=guide_legend( title="Emissions source",ncol=2, title.position="top", title.hjust = 0.5, override.aes=list(colour=NA))) +
theme(
legend.key = element_rect(colour="white"))
print(CEMISanim)
CEMIS <- CEMIS(ALLVAR, 2018, 2100)
CEMIS <- function(df, startyear, endyear){
df.intrapolate=seq(unique(df$Year)[1],endyear)
## Activate data.table package ###
dfreal=data.table(df)
#Intrapolatie with approximate
dfreal = dfreal[,list(approx(x=Year,y=value,xout=df.intrapolate)$y,
approx(x=Year,y=value,xout=df.intrapolate)$x),
by=eval(dput(names(dfreal[, -c("Year", "value")])))]
setnames(dfreal,"V1","value")
setnames(dfreal,"V2","Year")
dfreal=data.table(dfreal)
df = dfreal[Year %in% c(startyear:endyear)] %>%
group_by_at(names(dfreal[, -c("Year", "value")])) %>%
mutate(CEMIS=cumsum(value))
df = data.table(df)
}
CEMIS <- CEMIS(ALLVAR, 2018, 2100)
CEMIS=CEMIS[Variable %in% c(
"Emissions|CO2|Iron and Steel|Direct emissions",
"Emissions|CO2|Pulp and Paper|Direct emissions",
"Emissions|CO2|Chemicals and Petrochemicals|Direct emissions",
"Emissions|CO2|Food Processing|Direct emissions",
"Emissions|CO2|Cement|Direct emissions",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Energy|Supply|Electricity",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Energy|Demand|Industry",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Energy|Supply|Electricity",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Energy|Demand|Industry",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Industrial Processes|Pulp and Paper",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Industrial Processes|Pulp and Paper",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Industrial Processes|Iron and Steel",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Industrial Processes|Iron and Steel"
)]
CEMIS$Variable <- gsub("|Direct emissions", "", CEMIS$Variable, fixed=T )
CEMIS$Variable <- gsub("Emissions|CO2|", "", CEMIS$Variable, fixed=T )
CEMIS$Variable <- gsub("Emissions|CO2|Carbon Capture and Storage|", "", CEMIS$Variable, fixed=TRUE)
CEMIS$Variable <- gsub("Industrial Processes|", "", CEMIS$Variable, fixed=TRUE)
CEMISanim=ggplot()+
#geom_bar(data=fakeydata, aes(x=Region, y=value, fill=Variable), stat="identity", position="stack")+
geom_bar(data=CEMIS[Variable %in% c("Biomass|Industry","Fossil|Industry") & Region %in% c("EU28")], aes(x=Scenario, y=-CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
annotate("rect", xmin=-Inf,xmax=Inf,ymin=0,ymax=Inf, fill="lightgrey") +
annotate("rect", xmin=-Inf,xmax=Inf,ymin=-Inf,ymax=0, fill="lightblue") +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8, y=-25, label="CO[2]~Captured", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=0) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8, y=100, label="CO[2]~emitted", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=1) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
# # "Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing"
geom_bar(data=CEMIS[Variable %in% c("Biomass|Industry") & Region %in% c("EU28") ], aes(x=Scenario, y=CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMIS[Variable %in% c("Industry") & Region %in% c("EU28")], aes(x=Scenario, y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMIS[Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", " Cement") &  Region %in% c("EU28")], aes(x=Scenario, y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Gt"~CO[2])) + ggtitle(bquote(bold("Cumulative"~CO[2]~"emissions since 2018"))) +
coord_flip()+
theme(
axis.text.x = element_text(angle = 45, size=12,  hjust=1),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
axis.text.y = element_text(size=12),
strip.text.x = element_text(size=12, face="bold"),
strip.text.y = element_text(size=12, face="bold"),
legend.text= element_text(size=12),
legend.title=element_text(size=13,  face="bold"),
plot.title=element_text(size=16, hjust=0.5, face="bold"),
plot.subtitle=element_text(size=14,hjust=0.5),
panel.border = element_rect(colour = "black", size=1),
legend.key =  element_rect(fill = 'white', size = 0.5),
strip.background = element_rect(colour="white", fill="#FFFFFF")
) +
guides(fill=guide_legend( title="Emissions source",ncol=2, title.position="top", title.hjust = 0.5, override.aes=list(colour=NA))) +
theme(
legend.key = element_rect(colour="white"))
print(CEMISanim)
CEMISanim=ggplot()+
geom_bar(data=CEMIS[Variable %in% c("Industry") & Region %in% c("EU28")], aes(x=Scenario, y=CEMIS/1000), fill=' grey80', stat="identity", position="stack", colour="black")+
geom_bar(data=CEMIS[Variable %in% c("Biomass|Industry") & Region %in% c("EU28") ], aes(x=Scenario, y=CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMIS[Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", " Cement") &  Region %in% c("EU28")], aes(x=Scenario, y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Gt"~CO[2])) + ggtitle(bquote(bold("Cumulative"~CO[2]~"emissions since 2018"))) +
theme(
axis.text.x = element_text(angle = 45, size=12,  hjust=1),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
axis.text.y = element_text(size=12),
strip.text.x = element_text(size=12, face="bold"),
strip.text.y = element_text(size=12, face="bold"),
legend.text= element_text(size=12),
legend.title=element_text(size=13,  face="bold"),
plot.title=element_text(size=16, hjust=0.5, face="bold"),
plot.subtitle=element_text(size=14,hjust=0.5),
panel.border = element_rect(colour = "black", size=1),
legend.key =  element_rect(fill = 'white', size = 0.5),
strip.background = element_rect(colour="white", fill="#FFFFFF")
) +
guides(fill=guide_legend( title="Emissions source",ncol=2, title.position="top", title.hjust = 0.5, override.aes=list(colour=NA))) +
theme(
legend.key = element_rect(colour="white"))
print(CEMISanim)
CEMIS[Variable %in% c("Industry")]
CEMIS <- CEMIS(ALLVAR, 2018, 2100)
CEMIS <- function(df, startyear, endyear){
df.intrapolate=seq(unique(df$Year)[1],endyear)
## Activate data.table package ###
dfreal=data.table(df)
#Intrapolatie with approximate
dfreal = dfreal[,list(approx(x=Year,y=value,xout=df.intrapolate)$y,
approx(x=Year,y=value,xout=df.intrapolate)$x),
by=eval(dput(names(dfreal[, -c("Year", "value")])))]
setnames(dfreal,"V1","value")
setnames(dfreal,"V2","Year")
dfreal=data.table(dfreal)
df = dfreal[Year %in% c(startyear:endyear)] %>%
group_by_at(names(dfreal[, -c("Year", "value")])) %>%
mutate(CEMIS=cumsum(value))
df = data.table(df)
}
CumEMIS <- CEMIS(ALLVAR, 2018, 2100)
CumEMIS <- CEMIS(ALLVAR, 2018, 2100)
CumEMIS=CumEMIS[Variable %in% c(
"Emissions|CO2|Iron and Steel|Direct emissions",
"Emissions|CO2|Pulp and Paper|Direct emissions",
"Emissions|CO2|Chemicals and Petrochemicals|Direct emissions",
"Emissions|CO2|Food Processing|Direct emissions",
"Emissions|CO2|Cement|Direct emissions",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Energy|Supply|Electricity",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Energy|Demand|Industry",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Energy|Supply|Electricity",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Energy|Demand|Industry",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Industrial Processes|Pulp and Paper",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Industrial Processes|Pulp and Paper",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Industrial Processes|Iron and Steel",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Industrial Processes|Iron and Steel"
)]
CumEMIS$Variable <- gsub("|Direct emissions", "", CumEMIS$Variable, fixed=T )
CumEMIS$Variable <- gsub("Emissions|CO2|", "", CumEMIS$Variable, fixed=T )
CumEMIS$Variable <- gsub("Emissions|CO2|Carbon Capture and Storage|", "", CumEMIS$Variable, fixed=TRUE)
CumEMIS$Variable <- gsub("Industrial Processes|", "", CumEMIS$Variable, fixed=TRUE)
head(CumEMIS)
CumEMIS=CumEMIS[Variable %in% c(
"Emissions|CO2|Iron and Steel|Direct emissions",
"Emissions|CO2|Pulp and Paper|Direct emissions",
"Emissions|CO2|Chemicals and Petrochemicals|Direct emissions",
"Emissions|CO2|Food Processing|Direct emissions",
"Emissions|CO2|Cement|Direct emissions",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Energy|Supply|Electricity",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Energy|Demand|Industry",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Energy|Supply|Electricity",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Energy|Demand|Industry",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Industrial Processes|Pulp and Paper",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Industrial Processes|Pulp and Paper",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Industrial Processes|Iron and Steel",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Industrial Processes|Iron and Steel"
)]
CumEMIS$Variable <- gsub("|Direct emissions", "", CumEMIS$Variable, fixed=T )
CumEMIS$Variable <- gsub("Emissions|CO2|", "", CumEMIS$Variable, fixed=T )
CumEMIS$Variable <- gsub("Emissions|CO2|Carbon Capture and Storage|", "", CumEMIS$Variable, fixed=TRUE)
CumEMIS$Variable <- gsub("Carbon Capture and Storage|", "", CumEMIS$Variable, fixed=TRUE)
CumEMIS$Variable <- gsub("|Energy|Demand", "", CumEMIS$Variable, fixed=TRUE)
CumEMIS$Variable <- gsub("Industrial Processes|", "", CumEMIS$Variable, fixed=TRUE)
CEMISanim=ggplot()+
geom_bar(data=CumEMIS[Variable %in% c("Industry") & Region %in% c("EU28")], aes(x=Scenario, y=CEMIS/1000), fill=' grey80', stat="identity", position="stack", colour="black")+
geom_bar(data=CumEMIS[Variable %in% c("Biomass|Industry") & Region %in% c("EU28") ], aes(x=Scenario, y=CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CumEMIS[Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", " Cement") &  Region %in% c("EU28")], aes(x=Scenario, y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Gt"~CO[2])) + ggtitle(bquote(bold("Cumulative"~CO[2]~"emissions since 2018"))) +
theme(
axis.text.x = element_text(angle = 45, size=12,  hjust=1),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
axis.text.y = element_text(size=12),
strip.text.x = element_text(size=12, face="bold"),
strip.text.y = element_text(size=12, face="bold"),
legend.text= element_text(size=12),
legend.title=element_text(size=13,  face="bold"),
plot.title=element_text(size=16, hjust=0.5, face="bold"),
plot.subtitle=element_text(size=14,hjust=0.5),
panel.border = element_rect(colour = "black", size=1),
legend.key =  element_rect(fill = 'white', size = 0.5),
strip.background = element_rect(colour="white", fill="#FFFFFF")
) +
guides(fill=guide_legend( title="Emissions source",ncol=2, title.position="top", title.hjust = 0.5, override.aes=list(colour=NA))) +
theme(
legend.key = element_rect(colour="white"))
print(CEMISanim)
head(CumEMIS)
CumEMIS <- CEMIS(ALLVAR, 2018, 2100)
CumEMIS=CumEMIS[Variable %in% c(
"Emissions|CO2|Iron and Steel|Direct emissions",
"Emissions|CO2|Pulp and Paper|Direct emissions",
"Emissions|CO2|Chemicals and Petrochemicals|Direct emissions",
"Emissions|CO2|Food Processing|Direct emissions",
"Emissions|CO2|Cement|Direct emissions",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Energy|Supply|Electricity",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Energy|Demand|Industry",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Energy|Supply|Electricity",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Energy|Demand|Industry",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Industrial Processes|Pulp and Paper",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Industrial Processes|Pulp and Paper",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Industrial Processes|Iron and Steel",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Industrial Processes|Iron and Steel"
)]
CumEMIS$Variable <- gsub("|Direct emissions", "", CumEMIS$Variable, fixed=T )
CumEMIS$Variable <- gsub("Emissions|CO2|", "", CumEMIS$Variable, fixed=T )
CumEMIS$Variable <- gsub("Emissions|CO2|Carbon Capture and Storage|", "", CumEMIS$Variable, fixed=TRUE)
CumEMIS$Variable <- gsub("Carbon Capture and Storage|", "", CumEMIS$Variable, fixed=TRUE)
CumEMIS$Variable <- gsub("|Energy|Demand", "", CumEMIS$Variable, fixed=TRUE)
CumEMIS$Variable <- gsub("Industrial Processes|", "", CumEMIS$Variable, fixed=TRUE)
head(CumEMIS)
CEMISanim=ggplot()+
geom_bar(data=CumEMIS[Variable %in% c("Industry") & Region %in% c("EU28")], aes(x=Scenario, y=CEMIS/1000), fill=' grey80', stat="identity", position="stack", colour="black")+
geom_bar(data=CumEMIS[Variable %in% c("Biomass|Industry") & Region %in% c("EU28") ], aes(x=Scenario, y=CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CumEMIS[Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", " Cement") &  Region %in% c("EU28")], aes(x=Scenario, y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Gt"~CO[2])) + ggtitle(bquote(bold("Cumulative"~CO[2]~"emissions since 2018"))) +
theme(
axis.text.x = element_text(angle = 45, size=12,  hjust=1),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
axis.text.y = element_text(size=12),
strip.text.x = element_text(size=12, face="bold"),
strip.text.y = element_text(size=12, face="bold"),
legend.text= element_text(size=12),
legend.title=element_text(size=13,  face="bold"),
plot.title=element_text(size=16, hjust=0.5, face="bold"),
plot.subtitle=element_text(size=14,hjust=0.5),
panel.border = element_rect(colour = "black", size=1),
legend.key =  element_rect(fill = 'white', size = 0.5),
strip.background = element_rect(colour="white", fill="#FFFFFF")
) +
guides(fill=guide_legend( title="Emissions source",ncol=2, title.position="top", title.hjust = 0.5, override.aes=list(colour=NA))) +
theme(
legend.key = element_rect(colour="white"))
print(CEMISanim)
head(CumEMIS)
unique(CumEMIS$Variable)
CumEMIS=CumEMIS[Variable %in% c( "Emissions|CO2|Fossil Fuels and Industry|Energy Demand|Industry",
"Emissions|CO2|Iron and Steel|Direct emissions",
"Emissions|CO2|Pulp and Paper|Direct emissions",
"Emissions|CO2|Chemicals and Petrochemicals|Direct emissions",
"Emissions|CO2|Food Processing|Direct emissions",
"Emissions|CO2|Cement|Direct emissions",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Energy|Supply|Electricity",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Energy|Demand|Industry",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Energy|Supply|Electricity",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Energy|Demand|Industry",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Industrial Processes|Pulp and Paper",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Industrial Processes|Pulp and Paper",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Industrial Processes|Iron and Steel",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Industrial Processes|Iron and Steel"
)]
CumEMIS$Variable <- gsub("Emissions|CO2|Fossil Fuels and Industry|Energy Demand|", "", CumEMIS$Variable, fixed=T )
CumEMIS$Variable <- gsub("|Direct emissions", "", CumEMIS$Variable, fixed=T )
CumEMIS$Variable <- gsub("Emissions|CO2|", "", CumEMIS$Variable, fixed=T )
CumEMIS$Variable <- gsub("Emissions|CO2|Carbon Capture and Storage|", "", CumEMIS$Variable, fixed=TRUE)
CumEMIS$Variable <- gsub("Carbon Capture and Storage|", "", CumEMIS$Variable, fixed=TRUE)
CumEMIS$Variable <- gsub("|Energy|Demand", "", CumEMIS$Variable, fixed=TRUE)
CumEMIS$Variable <- gsub("Industrial Processes|", "", CumEMIS$Variable, fixed=TRUE)
CEMISanim=ggplot()+
geom_bar(data=CumEMIS[Variable %in% c("Industry") & Region %in% c("EU28")], aes(x=Scenario, y=CEMIS/1000), fill=' grey80', stat="identity", position="stack", colour="black")+
geom_bar(data=CumEMIS[Variable %in% c("Biomass|Industry") & Region %in% c("EU28") ], aes(x=Scenario, y=CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CumEMIS[Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", " Cement") &  Region %in% c("EU28")], aes(x=Scenario, y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Gt"~CO[2])) + ggtitle(bquote(bold("Cumulative"~CO[2]~"emissions since 2018"))) +
theme(
axis.text.x = element_text(angle = 45, size=12,  hjust=1),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
axis.text.y = element_text(size=12),
strip.text.x = element_text(size=12, face="bold"),
strip.text.y = element_text(size=12, face="bold"),
legend.text= element_text(size=12),
legend.title=element_text(size=13,  face="bold"),
plot.title=element_text(size=16, hjust=0.5, face="bold"),
plot.subtitle=element_text(size=14,hjust=0.5),
panel.border = element_rect(colour = "black", size=1),
legend.key =  element_rect(fill = 'white', size = 0.5),
strip.background = element_rect(colour="white", fill="#FFFFFF")
) +
guides(fill=guide_legend( title="Emissions source", title.position="top", title.hjust = 0.5, override.aes=list(colour=NA))) +
theme(
legend.key = element_rect(colour="white"))
print(CEMISanim)
transition_components(Year) +
exit_reset() +
labs(title = 'Year: {substr(frame_time, 1,4)} \n Final Energy Use per Carrier')
print(CEMISanim)
CumEMIS[Variable %in% c("Industry") & Region %in% c("EU28")]
CumEMIS <- CEMIS(ALLVAR, 2018, 2100)
CumEMIS=CumEMIS[Variable %in% c( "Emissions|CO2|Fossil Fuels and Industry|Energy Demand|Industry",
"Emissions|CO2|Iron and Steel|Direct emissions",
"Emissions|CO2|Pulp and Paper|Direct emissions",
"Emissions|CO2|Chemicals and Petrochemicals|Direct emissions",
"Emissions|CO2|Food Processing|Direct emissions",
"Emissions|CO2|Cement|Direct emissions",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Energy|Supply|Electricity",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Energy|Demand|Industry",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Energy|Supply|Electricity",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Energy|Demand|Industry",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Industrial Processes|Pulp and Paper",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Industrial Processes|Pulp and Paper",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Industrial Processes|Iron and Steel",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Industrial Processes|Iron and Steel"
)]
CumEMIS$Variable <- gsub("Emissions|CO2|Fossil Fuels and Industry|Energy Demand|", "", CumEMIS$Variable, fixed=T )
CumEMIS$Variable <- gsub("|Direct emissions", "", CumEMIS$Variable, fixed=T )
CumEMIS$Variable <- gsub("Emissions|CO2|", "", CumEMIS$Variable, fixed=T )
CumEMIS$Variable <- gsub("Emissions|CO2|Carbon Capture and Storage|", "", CumEMIS$Variable, fixed=TRUE)
CumEMIS$Variable <- gsub("Carbon Capture and Storage|", "", CumEMIS$Variable, fixed=TRUE)
CumEMIS$Variable <- gsub("|Energy|Demand", "", CumEMIS$Variable, fixed=TRUE)
CumEMIS$Variable <- gsub("Industrial Processes|", "", CumEMIS$Variable, fixed=TRUE)
CumEMIS[Variable %in% c("Industry") & Region %in% c("EU28")]
CEMISanim=ggplot()+
geom_bar(data=CumEMIS[Variable %in% c("Industry") & Region %in% c("EU28")], aes(x=Scenario, y=CEMIS/1000), fill=' grey80', stat="identity", position="stack", colour="black")+
geom_bar(data=CumEMIS[Variable %in% c("Biomass|Industry") & Region %in% c("EU28") ], aes(x=Scenario, y=CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CumEMIS[Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", " Cement") &  Region %in% c("EU28")], aes(x=Scenario, y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Gt"~CO[2])) + ggtitle(bquote(bold("Cumulative"~CO[2]~"emissions since 2018"))) +
theme(
axis.text.x = element_text(angle = 45, size=12,  hjust=1),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
axis.text.y = element_text(size=12),
strip.text.x = element_text(size=12, face="bold"),
strip.text.y = element_text(size=12, face="bold"),
legend.text= element_text(size=12),
legend.title=element_text(size=13,  face="bold"),
plot.title=element_text(size=16, hjust=0.5, face="bold"),
plot.subtitle=element_text(size=14,hjust=0.5),
panel.border = element_rect(colour = "black", size=1),
legend.key =  element_rect(fill = 'white', size = 0.5),
strip.background = element_rect(colour="white", fill="#FFFFFF")
) +
guides(fill=guide_legend( title="Emissions source", title.position="top", title.hjust = 0.5, override.aes=list(colour=NA))) +
theme(
legend.key = element_rect(colour="white"))
print(CEMISanim)
CumEMIS[Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", " Cement") &  Region %in% c("EU28")]
CEMISanim=ggplot()+
geom_bar(data=CumEMIS[Variable %in% c("Industry") & Region %in% c("EU28")], aes(x=Scenario, y=CEMIS/1000), fill=' grey80', stat="identity", position="stack", colour="black")+
geom_bar(data=CumEMIS[Variable %in% c("Biomass|Industry") & Region %in% c("EU28") ], aes(x=Scenario, y=-CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CumEMIS[Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", " Cement") &  Region %in% c("EU28")], aes(x=Scenario, y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Gt"~CO[2])) + ggtitle(bquote(bold("Cumulative"~CO[2]~"emissions since 2018"))) +
theme(
axis.text.x = element_text(angle = 45, size=12,  hjust=1),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
axis.text.y = element_text(size=12),
strip.text.x = element_text(size=12, face="bold"),
strip.text.y = element_text(size=12, face="bold"),
legend.text= element_text(size=12),
legend.title=element_text(size=13,  face="bold"),
plot.title=element_text(size=16, hjust=0.5, face="bold"),
plot.subtitle=element_text(size=14,hjust=0.5),
panel.border = element_rect(colour = "black", size=1),
legend.key =  element_rect(fill = 'white', size = 0.5),
strip.background = element_rect(colour="white", fill="#FFFFFF")
)
print(CEMISanim)
CumEMIS[Variable %in% c("Industry") & Region %in% c("EU28")]
CEMISanim=ggplot()+
geom_bar(data=CumEMIS[Variable %in% c("Industry") & Region %in% c("EU28")], aes(x=Scenario, y=CEMIS/1000), fill='grey80', stat="identity", position="stack", colour="black")+
geom_bar(data=CumEMIS[Variable %in% c("Biomass|Industry") & Region %in% c("EU28") ], aes(x=Scenario, y=-CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CumEMIS[Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", " Cement") &  Region %in% c("EU28")], aes(x=Scenario, y=CEMIS/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Gt"~CO[2])) + ggtitle(bquote(bold("Cumulative"~CO[2]~"emissions since 2018"))) +
theme(
axis.text.x = element_text(angle = 45, size=12,  hjust=1),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
axis.text.y = element_text(size=12),
strip.text.x = element_text(size=12, face="bold"),
strip.text.y = element_text(size=12, face="bold"),
legend.text= element_text(size=12),
legend.title=element_text(size=13,  face="bold"),
plot.title=element_text(size=16, hjust=0.5, face="bold"),
plot.subtitle=element_text(size=14,hjust=0.5),
panel.border = element_rect(colour = "black", size=1),
legend.key =  element_rect(fill = 'white', size = 0.5),
strip.background = element_rect(colour="white", fill="#FFFFFF")
)
print(CEMISanim)
CEMISanim=ggplot()+
geom_bar(data=CumEMIS[Variable %in% c("Industry") & Region %in% c("EU28")], aes(x=Scenario, y=CEMIS/1000), fill='grey80', stat="identity", position="stack", colour="black")+
theme(
axis.text.x = element_text(angle = 45, size=12,  hjust=1),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
axis.text.y = element_text(size=12),
strip.text.x = element_text(size=12, face="bold"),
strip.text.y = element_text(size=12, face="bold"),
legend.text= element_text(size=12),
legend.title=element_text(size=13,  face="bold"),
plot.title=element_text(size=16, hjust=0.5, face="bold"),
plot.subtitle=element_text(size=14,hjust=0.5),
panel.border = element_rect(colour = "black", size=1),
legend.key =  element_rect(fill = 'white', size = 0.5),
strip.background = element_rect(colour="white", fill="#FFFFFF")
)
print(CEMISanim)
head(CumEMIS[Variable %in% c("Industry") & Region %in% c("EU28")])
