geom_line(data=WSP.foodemis[!Scenario=="BL" & Sector=="Food"], aes(x=Year, y=ByBL, colour=Study, group=Scenario), size=1 ) +
geom_line(data=WSP.foodemis[Scenario=="BL" & Sector=="Food"], aes(x=Year, y=ByBL, colour=Study, group=Scenario), size=1, linetype=2 ) +
#Audrey et al (2009) (WWF) all areas scenario.  this is UK based
geom_line(data=data.table(Year=c(2010,2050),
Study=c(rep("Audsley et al. (2009)",2)),
Scenario=c(rep("Baseline", 2)),
ByY=c(100,100)), aes(x=Year, y=ByY, colour=Study, group=Scenario), size=1, linetype=2 ) +
facet_wrap(~Sector, ncol=1) +
coord_cartesian(xlim=c(2005:2050), ylim=c(0:150)) +
theme_bw() +
ggtitle("Compared to baseline") +
labs(y="Index (BL=100) ", x = "Year") +
guides(fill=guide_legend("Sector"))+
GROBTHEME
print(INDFOODemisbl)
##########################################
####### CHEM EMIS FOOD SECTOR
get_legend<-function(myggplot){
tmp <- ggplot_gtable(ggplot_build(myggplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)
}
legend.figfutindemisfood <- get_legend(INDFOODemisbl)
FUTUREFIGInd.foodemis <-arrangeGrob(arrangeGrob(INDFOODemisbl+theme(legend.position="none"),
INDFOODemisby+theme(legend.position="none"),
nrow = 1,
widths=c(2,2)),
arrangeGrob(blank,
legend.figfutindemisfood,
arrangeGrob(legend.figfutlinetype,
blank,
nrow=1, widths=c(1,0.3)),
blank,
ncol=1),
nrow = 1,
ncol = 2,
widths=c(4,1.5),
left = textGrob("", rot = 90, vjust = 1, gp=gpar(fontsize=12)))
grid.newpage()
grid.draw(FUTUREFIGInd.foodemis)
png("PDF/FOOD_emissions_studies.png", width=700, height=300)
grid.newpage()
grid.draw(FUTUREFIGInd.foodemis)
dev.off()
#################################################################
##################### CHEM PRODUCTION ##########################
#################################################################
########################################################################
############ Production data IEA (in Mt)
########################################################################
IEAprod2DS=data.table(Year=c(2010,2050,2010,2050),
Demand=c("Low-demand", "Low-demand","High-demand","High-demand"),
Ethylene=c(123,277,123, 290),
Propylene=c(77,178, 77, 158),
BTX=c(105,254,105,234))
IEAprod2DS$Scenario <- "2DS"
IEAprod6DS=data.table(Year=c(2010,2050,2010,2050),
Demand=c("Low-demand", "Low-demand","High-demand","High-demand"),
Ethylene=c(123,320,123, 374),
Propylene=c(77,208, 77, 243),
BTX=c(105,283,105,331))
IEAprod6DS$Scenario <- "BL"
IEAprod=rbind(IEAprod2DS,IEAprod6DS)
IEAprod=gather(IEAprod, HVC, value, by=c("Ethylene", "Propylene", "BTX"))
IEAprod=data.table(IEAprod)
IEAprod=merge(IEAprod,IEAprod[Year=="2010", -c("Year")], by=c("Demand", "HVC", "Scenario"))
setnames(IEAprod, "value.y", "Y2010")
IEAprod=merge(IEAprod,IEAprod[Scenario=="BL", -c("Scenario")], by=c("Demand", "HVC", "Year", "Y2010"))
setnames(IEAprod, "value.x.x", "value")
setnames(IEAprod, "value.x.y", "BL")
IEAprod = IEAprod %>% mutate(ByBL=(value/BL)*100, ByY=(value/Y2010)*100, ByX=(BL/Y2010)*100)
IEAprod=data.table(IEAprod)
IEAprod$Study<- "IEA (2013)"
## DECHEMA (2016 p. 107 production in Mt)
DECHEMABAU=data.table(Year=c(2015,2030,2050),
Demand=c("Production", "Production","Production"),
Scenario=c(rep("BL", 3)),
Ethylene=c(20,36,45),
Propylene=c(15,18, 12),
BTX=c(12, 20,23),
HVC=c(52, 65, 88))
DECHEMABAU=gather(DECHEMABAU, HVC, value, by=c("Ethylene", "Propylene", "BTX", "HVC"))
DECHEMABAU=data.table(DECHEMABAU)
DECHEMABAU=merge(DECHEMABAU,DECHEMABAU[Year=="2015", -c("Year")], by=c("Demand", "HVC", "Scenario"))
setnames(DECHEMABAU, "value.y", "Y2015")
DECHEMABAU=merge(DECHEMABAU,DECHEMABAU[Scenario=="BL", -c("Scenario")], by=c("Demand", "HVC", "Year", "Y2015"))
setnames(DECHEMABAU, "value.x.x", "value")
setnames(DECHEMABAU, "value.x.y", "BL")
DECHEMABAU = DECHEMABAU %>% mutate(ByBL=(value/BL)*100, ByY=(value/Y2015)*100, ByX=(BL/Y2015)*100)
DECHEMABAU=data.table(DECHEMABAU)
DECHEMABAU$Study<- "DECHEMA (2017)"
## plot
#D4.2
PRODVOLmergecalcindexnew= PRODVOLmergecalcindex
PRODVOLmergecalcindexnew=PRODVOLmergecalcindexnew[Variable=="Chemical|HVC|Total Demand", Variable:=c("HVC")]
setnames(PRODVOLmergecalcindexnew, "Model", "Study")
# Plot graph: PER SECTOR IN TOTAL., NOTE IEA DATA IN KTOE.  1ktoe =~42PJ
INDCHEMprodby=ggplot() +
geom_hline(yintercept=100, linetype=2) +
#
# geom_line(data=IEAprod[!Scenario=="BL" & !HVC=="BTX"], aes(x=Year, y=ByY, colour=Study, group=Demand), size=1 ) +
# geom_line(data=IEAprod[Scenario=="BL"  & !HVC=="BTX"], aes(x=Year, y=ByX, colour=Study, group=Demand), size=1, linetype=2 ) +
#Lechtenböhmer et al. (2013)
#geom_line(data=data.table(HVC=c(rep("Ethylene",3)), Year=c(2010,2030,2050), ByY=c(100,110,75), Study=c(rep("Lechenböhmer et al. (2015)"))), aes(x=Year, y=ByY, colour=Study, group=Study), size=1 ) +
# Broeren et al. 2014.  (p. 280) I transformed original values (Mt/yr) to indexed values with my brain
geom_line(data=data.table(HVC=c(rep("HVC",2)), Year=c(2010,2030), ByY=c(100, 187), Study=c(rep("Broeren et al. (2014)"))), aes(x=Year, y=ByY, colour=Study, group=Study), size=1 ) +
#DECHEMA (2016)
geom_line(data=DECHEMABAU[Scenario=="BL" & HVC=="HVC" ], aes(x=Year, y=ByX, colour=interaction(Study), group=Demand), size=1 ) +
# Dornburg et al (2008) based on "Organic chemical market" growth assumption (0-3% p.a.)
geom_line(data=data.table(HVC=c(rep("HVC",4)), Year=c(2000,2050), ByY=c(100, 211), Study=c(rep("Dornburg et al. (2008)"))), aes(x=Year, y=ByY, colour=Study, group=Study), size=1 ) +
geom_line(data=data.table(HVC=c(rep("HVC",4)), Year=c(2000,2050), ByY=c(100, 100), Study=c(rep("Dornburg et al. (2008)"))), aes(x=Year, y=ByY, colour=Study, group=Study), size=1 ) +
# IMAGE
geom_line(data=PRODVOLmergecalcindexnew[Region=="EU28" & Variable=="HVC" & !Scenario=="Baseline"], aes(x=Year.x, y=index, colour=Study, group=Scenario, linetype=Scenario), size=1 ) +
#geom_line(data=PRODVOLmergecalcindexnew[Region=="World" & Variable=="HVC" & !Scenario=="SSP2"], aes(x=Year.x, y=index, colour=Study, group=Scenario, linetype=Scenario), size=1 ) +
# WISEE
geom_line(data=WISEECO2[Sector=="Chemical" & Variable=="Production"], aes(x=Year.x, y=value.x, group=Scenario, linetype=Scenario, colour=Study), size=1) +
scale_colour_manual(values=c('#d7191c','#fdae61', '#2c7bb6', '#000000', 'green'),
breaks=c("Broeren et al. (2014)", "DECHEMA (2017)", "Dornburg et al. (2008)",  "IMAGE", "WISEE")
) +
facet_wrap(~HVC, ncol=1) +
coord_cartesian(xlim=c(2005:2050), ylim=c(0:250)) +
theme_bw() +
ggtitle("Production volumes") +
labs(y="Index (2010=100) ", x = "Year") +
guides(fill=guide_legend("Sector"))+
scale_linetype_manual(values=c(3,1,3,1))+
# scale_colour_manual(values=c("#4bbff2","#a5ae64"),
#                     breaks=c("EU1", "EU9"),
#                     labels = c("No policy baseline",
#                                "80% reduction by 2050 [optimistic]")) +
GROBTHEME
print(INDCHEMprodby)
png("figures/Lit_compare_PRODVOL_HVC.png", width=500, height=400)
grid.newpage()
grid.draw(INDCHEMprodby)
dev.off()
### STeel
PRODVOLmergecalcindexnew = PRODVOLmergecalcindexnew[Variable=="Iron and Steel|Crude Steel", Variable:=c("Iron and Steel")]
# Plot graph: PER SECTOR IN TOTAL., NOTE IEA DATA IN KTOE.  1ktoe =~42PJ
INDSTEELprodby=ggplot() +
geom_hline(yintercept=100, linetype=2) +
# WISEE
geom_line(data=D41STEEL[Indicator=="Production"], aes(x=Target, y=index, group=Scenario, colour=Study), size=1) +
# IMAGE
geom_line(data=PRODVOLmergecalcindexnew[Region=="EU28" & Variable=="Iron and Steel" & !Scenario=="Baseline"], aes(x=Year.x, y=index, colour=Study, group=Scenario, linetype=Scenario), size=1 ) +
#geom_line(data=PRODVOLmergecalcindexnew[Region=="World" & Variable=="HVC" & !Scenario=="SSP2"], aes(x=Year.x, y=index, colour=Study, group=Scenario, linetype=Scenario), size=1 ) +
scale_colour_manual(values=c('#d53e4f','#f46d43','#fdae61', "black",'#fee08b','#e6f598','#abdda4','#66c2a5','#3288bd'),
breaks=c("Allwood et al. (2010)", "Bellevrat et al. (2009)", "Boston Consulting Group (2013)", "Milford et al. (2013)", "OECD/IEA (2009)", "OECD/IEA (2017)", "Pardo et al. (2012)", "van Ruiven et al. (2016)", "IMAGE")
) +
facet_wrap(~Variable, ncol=1) +
coord_cartesian(xlim=c(2005:2050), ylim=c(0:250)) +
theme_bw() +
ggtitle("Production volumes") +
labs(y="Index (2010=100) ", x = "Year") +
guides(fill=guide_legend("Sector"))+
# scale_linetype_manual(values=c(3,1,3,1))+
# scale_colour_manual(values=c("#4bbff2","#a5ae64"),
#                     breaks=c("EU1", "EU9"),
#                     labels = c("No policy baseline",
#                                "80% reduction by 2050 [optimistic]")) +
GROBTHEME
print(INDSTEELprodby)
png("figures/Lit_compare_PRODVOL_Steel.png", width=550, height=350)
grid.newpage()
grid.draw(INDSTEELprodby)
dev.off()
########################################################################
############ FOOD Production data (in KTonnes) OECD FAO https://stats.oecd.org/Index.aspx?DataSetCode=HIGH_AGLINK_2017#
########################################################################
# Meat consumption 1990-2025 (in tonnes).FAO Agriculture Outlook: https://stats.oecd.org/Index.aspx?DataSetCode=HIGH_AGLINK_2017#
setwd("~/disks/y/ontwapps/Timer/Users/Mariesse/R/REINVENT/DEVELOPMENT/IEA")
FAOMEAT= read.csv("OECDFAO_Agricultural_outlook_20172026.csv", sep=",", dec=".")
FAOMEAT=data.table(FAOMEAT)
FAOMEAT.eu=FAOMEAT[COUNTRY=="EUR" & Variable=="Production" & !COMMODITY=="DAIRY"]
FAOMEAT.eu=merge(FAOMEAT.eu, FAOMEAT.eu[Time=="2015", -c("TIME", "Time","Flag.Codes", "Flags")], by=c("COUNTRY", "Country", "COMMODITY", "Commodity", "VARIABLE", "Variable"))
setnames(FAOMEAT.eu, "Value.y", "Y2010")
setnames(FAOMEAT.eu, "Value.x", "Value")
FAOMEAT.eu=FAOMEAT.eu %>% mutate(ByY=(Value/Y2010)*100)
FAOMEAT.eu=data.table(FAOMEAT.eu)
FAOMEAT.eu$Study <- "OECD-FAO (2017)"
FAOMEAT.eu$Label <- paste (FAOMEAT.eu$COMMODITY, FAOMEAT.eu$Commodity)
FAOMEAT.eumilk=FAOMEAT.eu[COMMODITY %in% c("BT", "CA", "CH", "FDP", "MK", "SMP", "WMP", "WYP")]
FAOMEAT.eumilk$Food <- "Dairy"
FAOMEAT.eumeat=FAOMEAT.eu[!COMMODITY %in% c("BT", "CA", "CH", "FDP", "MK", "SMP", "WMP", "WYP")]
FAOMEAT.eumeat$Food <- "Meat"
setwd("/mnt/scratch/sluisveldvm/sluisveldvm/R/REINVENT/DEVELOPMENT/Scenarios")
FAODATA=rbind(FAOMEAT.eumilk, FAOMEAT.eumeat)
FAODATA=data.table(FAODATA)
FAODATA= FAODATA[, sum(Value, na.rm=T), by=c("Time", "Food", "Study", "Country")]
FAODATA2010=FAODATA[Time=="2010"]
FAODATA=merge(FAODATA, FAODATA2010, by=c("Food", "Study", "Country"))
FAODATAcalc=FAODATA %>% mutate(index=(V1.x/V1.y)*100)
PRODVOLmergecalcindexnewfood=PRODVOLmergecalcindexnew
setnames(PRODVOLmergecalcindexnewfood,"Variable", "Food")
# Plot graph: PER SECTOR IN TOTAL., NOTE IEA DATA IN KTOE.  1ktoe =~42PJ
INDFOODprodby=ggplot() +
geom_hline(yintercept=100, linetype=2) +
#
#geom_line(data=(FAOMEAT.eumeat), aes(x=Time, y=ByY, colour=Study, group=Commodity), size=1) +
# geom_label(data=FAOMEAT.eumeat[Time=="2026"], aes(x=Time, y=ByY, label=COMMODITY), size=3) +
# geom_label(data=FAOMEAT.eumilk[Time=="2026"], aes(x=Time, y=ByY, label=COMMODITY), size=3) +
# IMAGE
geom_line(data=PRODVOLmergecalcindexnewfood[Region=="EU28" & Food %in% c("Dairy", "Meat") & !Scenario=="SSP2"], aes(x=Year.x, y=index, colour=Study, group=Scenario, linetype=Scenario), size=1 ) +
#FAO
geom_line(data=FAODATAcalc, aes(x=Time.x, y=index, colour=Study, group=Food), size=1 ) +
scale_colour_manual(values=c( '#000000', '#fdae61'),
breaks=c("OECD-FAO (2017)",  "IMAGE")
) +
facet_wrap(~Food, nrow=1) +
coord_cartesian(xlim=c(2010:2030), ylim=c(60:145)) +
theme_bw() +
ggtitle("Production volume over time") +
labs(y="Index (2015=100) ", x = "Year") +
guides(colour=guide_legend("Study"))+
GROBTHEME
print(INDFOODprodby)
setwd("/mnt/scratch/sluisveldvm/sluisveldvm/R/REINVENT/DEVELOPMENT")
# Meat consumption 1990-2025 (in tonnes).FAO Agriculture Outlook: https://stats.oecd.org/Index.aspx?DataSetCode=HIGH_AGLINK_2017#
setwd("/mnt/scratch/sluisveldvm/sluisveldvm/R/REINVENT/DEVELOPMENT/IEA")
FAOMEAT= read.csv("OECDFAO_Agricultural_outlook_20172026.csv", sep=",", dec=".")
FAOMEAT=data.table(FAOMEAT)
FAOMEAT.eu=FAOMEAT[COUNTRY=="EUR" & Variable=="Production" & !COMMODITY=="DAIRY"]
FAOMEAT.eu=merge(FAOMEAT.eu, FAOMEAT.eu[Time=="2015", -c("TIME", "Time","Flag.Codes", "Flags")], by=c("COUNTRY", "Country", "COMMODITY", "Commodity", "VARIABLE", "Variable"))
setnames(FAOMEAT.eu, "Value.y", "Y2010")
setnames(FAOMEAT.eu, "Value.x", "Value")
FAOMEAT.eu=FAOMEAT.eu %>% mutate(ByY=(Value/Y2010)*100)
FAOMEAT.eu=data.table(FAOMEAT.eu)
FAOMEAT.eu$Study <- "OECD-FAO (2017)"
FAOMEAT.eu$Label <- paste (FAOMEAT.eu$COMMODITY, FAOMEAT.eu$Commodity)
FAOMEAT.eumilk=FAOMEAT.eu[COMMODITY %in% c("BT", "CA", "CH", "FDP", "MK", "SMP", "WMP", "WYP")]
FAOMEAT.eumilk$Food <- "Dairy"
FAOMEAT.eumeat=FAOMEAT.eu[!COMMODITY %in% c("BT", "CA", "CH", "FDP", "MK", "SMP", "WMP", "WYP")]
FAOMEAT.eumeat$Food <- "Meat"
setwd("/mnt/scratch/sluisveldvm/sluisveldvm/R/REINVENT/DEVELOPMENT/Scenarios")
FAODATA=rbind(FAOMEAT.eumilk, FAOMEAT.eumeat)
FAODATA=data.table(FAODATA)
FAODATA= FAODATA[, sum(Value, na.rm=T), by=c("Time", "Food", "Study", "Country")]
FAODATA2010=FAODATA[Time=="2010"]
FAODATA=merge(FAODATA, FAODATA2010, by=c("Food", "Study", "Country"))
FAODATAcalc=FAODATA %>% mutate(index=(V1.x/V1.y)*100)
PRODVOLmergecalcindexnewfood=PRODVOLmergecalcindexnew
setnames(PRODVOLmergecalcindexnewfood,"Variable", "Food")
# Plot graph: PER SECTOR IN TOTAL., NOTE IEA DATA IN KTOE.  1ktoe =~42PJ
INDFOODprodby=ggplot() +
geom_hline(yintercept=100, linetype=2) +
#
#geom_line(data=(FAOMEAT.eumeat), aes(x=Time, y=ByY, colour=Study, group=Commodity), size=1) +
# geom_label(data=FAOMEAT.eumeat[Time=="2026"], aes(x=Time, y=ByY, label=COMMODITY), size=3) +
# geom_label(data=FAOMEAT.eumilk[Time=="2026"], aes(x=Time, y=ByY, label=COMMODITY), size=3) +
# IMAGE
geom_line(data=PRODVOLmergecalcindexnewfood[Region=="EU28" & Food %in% c("Dairy", "Meat") & !Scenario=="SSP2"], aes(x=Year.x, y=index, colour=Study, group=Scenario, linetype=Scenario), size=1 ) +
#FAO
geom_line(data=FAODATAcalc, aes(x=Time.x, y=index, colour=Study, group=Food), size=1 ) +
scale_colour_manual(values=c( '#000000', '#fdae61'),
breaks=c("OECD-FAO (2017)",  "IMAGE")
) +
facet_wrap(~Food, nrow=1) +
coord_cartesian(xlim=c(2010:2030), ylim=c(60:145)) +
theme_bw() +
ggtitle("Production volume over time") +
labs(y="Index (2015=100) ", x = "Year") +
guides(colour=guide_legend("Study"))+
GROBTHEME
print(INDFOODprodby)
###
get_legend<-function(myggplot){
tmp <- ggplot_gtable(ggplot_build(myggplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)
}
legend.overview <- get_legend(ECONOMYemis152CTotal)
#IAMC abstract
# a grob in a grob in a grob
LITREVIEW <-arrangeGrob(arrangeGrob(IEATOTDEMFUTy2005IMAGECO2+ theme(
#legend.position="none",
plot.title = element_text(hjust=0.5, size=16),
plot.subtitle= element_blank(),
panel.border = element_rect(colour = "black", size=1),
axis.title.x = element_blank(),
#axis.title.y = element_blank(),
axis.text.x = element_text(margin=margin(7,5,10,5,"pt"), size=13),
axis.text.y = element_text(hjust=0.5, size=13),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_rect(colour="white", fill="#FFFFFF"))),
arrangeGrob(INDTEELemisby
+ theme(
#legend.position="none",
plot.title = element_blank(),
plot.subtitle= element_blank(),
panel.border = element_rect(colour = "black", size=1),
axis.title.x = element_blank(),
# axis.title.y = element_blank(),
axis.text.x = element_text(margin=margin(7,5,10,5,"pt"), size=13),
axis.text.y =  element_text(hjust=0.5, size=13),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_rect(colour="white", fill="#FFFFFF"),
legend.position="bottom",
legend.direction="vertical"),
arrangeGrob(INDCHEMemisby+ theme(
#legend.position="none",
plot.title = element_blank(),
plot.subtitle= element_blank(),
legend.position="bottom",
legend.direction="vertical"), nullGrob(), ncol=1, heights=c(5.5,1)),
arrangeGrob(INDPPIemisby+ theme(
#legend.position="none",
plot.title = element_blank(),
plot.subtitle= element_blank(),
legend.position="bottom",
legend.direction="vertical"), nullGrob(), ncol=1, heights=c(25,1)),
nrow=1,
widths = c(2,2,2) ),
ncol=1,
bottom=NULL,
#left=textGrob("Index (2010 = 100)", vjust = 0.5, rot=90, gp=gpar(fontsize=14)) ,
heights=c(4,2.5))
grid.newpage()
grid.draw(LITREVIEW)
# Plot graph: PER SECTOR IN TOTAL., NOTE IEA DATA IN KTOE.  1ktoe =~42PJ
IEATOTDEMFUTy2005IMAGECO2=ggplot() +
# Removed: , "Value Added|Industry"
#geom_line(data=EMF28meltEU.stand[Variable %in% c("Final Energy|Industry", "Emissions|CO2|||Industry") & Scenario %in% c("EU1")], aes(x=Year, y=ByY, colour=Study, group=Model), linetype=2 ) +
geom_line(data=EMF28meltEU.stand[Variable %in% c( "Emissions|CO2|||Industry") & Scenario %in% c("EU9")], aes(x=Year, y=ByY, colour=Study, group=Model) ) +
geom_hline(yintercept=100, linetype=2) +
geom_line(data=EIAETP2017[!Scenario=="BL" & Variable %in% c( "Emissions|CO2|||Industry")], aes(x=Year, y=ByY, colour=Study, group=Scenario) ) +
#geom_line(data=EIAETP2017, aes(x=Year, y=ByX, colour=Study, group=Scenario), size=1, linetype=2 ) +
geom_line(data=ADAM[!Scenario=="BL" & Variable %in% c( "Emissions|CO2|||Industry")], aes(x=Year, y=ByY, colour=Study, group=Scenario) ) +
#geom_line(data=ADAM, aes(x=Year, y=ByX, colour=Study, group=Scenario), size=1, linetype=2 ) +
geom_line(data=Fragosdatacalc[!Scenario=="BL" & Variable %in% c( "Emissions|CO2|||Industry")], aes(x=Year, y=ByY, colour=Study, group=Scenario)) +
#geom_line(data=Fragosdatacalc, aes(x=Year, y=ByX, colour=Study, group=Scenario), size=1, linetype=2 ) +
geom_line(data=IMAGEFINECO2calc[Variable %in% c( "Emissions|CO2|||Industry")], aes(x=Year.x, y=INDEX, group=Scenario, linetype=Scenario, colour=Study)) +
geom_line(data=IMAGEFINECO2calc[Variable %in% c( "Emissions|CO2|||Industry")], aes(x=Year.x, y=INDEX, group=Scenario, linetype=Scenario, colour=Study), size=1.5, colour="black") +
facet_wrap(~Variable, ncol=2, labeller= change) +
coord_cartesian(xlim=c(2005:2050), ylim=c(0:150)) +
theme_bw() +
ggtitle("Industry decarbonisation trajectories") +
labs(y="Index (2015=100) ", x = "Year") +
guides(fill=guide_legend("Sector"))+
scale_colour_manual(values=c('#d7191c','#fdae61', '#000000','#abd9e9','#2c7bb6'),
breaks=c("Förster et al. (2013)", "Fragkos et al. (2017)", "OECD/IEA (2017b)", "Schade et al. (2009)", "IMAGE")
) +
GROBTHEME
print(IEATOTDEMFUTy2005IMAGECO2)
#D4.2
IMAGEFINECO2=ALLVAR[Variable %in% c("Final Energy|industry", "Emissions|CO2|Fossil Fuels and Industry|Energy Demand|Industry") & Scenario %in% c("1.5 Degrees", "2 Degrees") & Region=="EU28"]
IMAGEFINECO22010=IMAGEFINECO2[Year=="2010"]
IMAGEFINECO2calc=merge(IMAGEFINECO2, IMAGEFINECO22010, by=c("Variable", "Scenario", "Unit", "Model", "Region"))
IMAGEFINECO2calc=IMAGEFINECO2calc %>% mutate(INDEX=(value.x/value.y)*100)
IMAGEFINECO2calc=data.table(IMAGEFINECO2calc)
IMAGEFINECO2calc=IMAGEFINECO2calc[Variable=="Emissions|CO2|Fossil Fuels and Industry|Energy Demand|Industry", Variable:=c("Emissions|CO2|||Industry")]
IMAGEFINECO2calc=IMAGEFINECO2calc[Variable=="Final Energy|industry", Variable:=c("Final Energy|Industry")]
setnames(IMAGEFINECO2calc, "Model", "Study")
# Plot graph: PER SECTOR IN TOTAL., NOTE IEA DATA IN KTOE.  1ktoe =~42PJ
IEATOTDEMFUTy2005IMAGE=ggplot() +
# Removed: , "Value Added|Industry"
#geom_line(data=EMF28meltEU.stand[Variable %in% c("Final Energy|Industry", "Emissions|CO2|||Industry") & Scenario %in% c("EU1")], aes(x=Year, y=ByY, colour=Study, group=Model), linetype=2 ) +
geom_line(data=EMF28meltEU.stand[Variable %in% c("Final Energy|Industry", "Emissions|CO2|||Industry") & Scenario %in% c("EU9")], aes(x=Year, y=ByY, colour=Study, group=Model) ) +
geom_hline(yintercept=100, linetype=2) +
geom_line(data=EIAETP2017[!Scenario=="BL"], aes(x=Year, y=ByY, colour=Study, group=Scenario) ) +
#geom_line(data=EIAETP2017, aes(x=Year, y=ByX, colour=Study, group=Scenario), size=1, linetype=2 ) +
geom_line(data=ADAM[!Scenario=="BL"], aes(x=Year, y=ByY, colour=Study, group=Scenario) ) +
#geom_line(data=ADAM, aes(x=Year, y=ByX, colour=Study, group=Scenario), size=1, linetype=2 ) +
geom_line(data=Fragosdatacalc[!Scenario=="BL"], aes(x=Year, y=ByY, colour=Study, group=Scenario)) +
#geom_line(data=Fragosdatacalc, aes(x=Year, y=ByX, colour=Study, group=Scenario), size=1, linetype=2 ) +
geom_line(data=IMAGEFINECO2calc, aes(x=Year.x, y=INDEX, group=Scenario, linetype=Scenario, colour=Study)) +
geom_line(data=IMAGEFINECO2calc, aes(x=Year.x, y=INDEX, group=Scenario, linetype=Scenario, colour=Study), size=1.5, colour="black") +
facet_wrap(~Variable, ncol=2, labeller= change) +
coord_cartesian(xlim=c(2005:2050), ylim=c(0:150)) +
theme_bw() +
ggtitle("Industry decarbonisation trajectories") +
labs(y="Index (2015=100) ", x = "Year") +
guides(fill=guide_legend("Sector"))+
scale_colour_manual(values=c('#d7191c','#fdae61', '#000000','#abd9e9','#2c7bb6'),
breaks=c("Förster et al. (2013)", "Fragkos et al. (2017)", "OECD/IEA (2017b)", "Schade et al. (2009)", "IMAGE")
) +
GROBTHEME
print(IEATOTDEMFUTy2005IMAGE)
# a grob in a grob in a grob
LITREVIEW <-arrangeGrob(arrangeGrob(IEATOTDEMFUTy2005IMAGECO2+ theme(
#legend.position="none",
plot.title = element_text(hjust=0.5, size=16),
plot.subtitle= element_blank(),
panel.border = element_rect(colour = "black", size=1),
axis.title.x = element_blank(),
#axis.title.y = element_blank(),
axis.text.x = element_text(margin=margin(7,5,10,5,"pt"), size=13),
axis.text.y = element_text(hjust=0.5, size=13),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_rect(colour="white", fill="#FFFFFF"))),
arrangeGrob(INDTEELemisby
+ theme(
#legend.position="none",
plot.title = element_blank(),
plot.subtitle= element_blank(),
panel.border = element_rect(colour = "black", size=1),
axis.title.x = element_blank(),
# axis.title.y = element_blank(),
axis.text.x = element_text(margin=margin(7,5,10,5,"pt"), size=13),
axis.text.y =  element_text(hjust=0.5, size=13),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_rect(colour="white", fill="#FFFFFF"),
legend.position="bottom",
legend.direction="vertical"),
arrangeGrob(INDCHEMemisby+ theme(
#legend.position="none",
plot.title = element_blank(),
plot.subtitle= element_blank(),
legend.position="bottom",
legend.direction="vertical"), nullGrob(), ncol=1, heights=c(5.5,1)),
arrangeGrob(INDPPIemisby+ theme(
#legend.position="none",
plot.title = element_blank(),
plot.subtitle= element_blank(),
legend.position="bottom",
legend.direction="vertical"), nullGrob(), ncol=1, heights=c(25,1)),
nrow=1,
widths = c(2,2,2) ),
ncol=1,
bottom=NULL,
#left=textGrob("Index (2010 = 100)", vjust = 0.5, rot=90, gp=gpar(fontsize=14)) ,
heights=c(4,2.5))
grid.newpage()
grid.draw(LITREVIEW)
IEATOTDEMFUTy2005IMAGECO2=ggplot() +
# Removed: , "Value Added|Industry"
#geom_line(data=EMF28meltEU.stand[Variable %in% c("Final Energy|Industry", "Emissions|CO2|||Industry") & Scenario %in% c("EU1")], aes(x=Year, y=ByY, colour=Study, group=Model), linetype=2 ) +
geom_line(data=EMF28meltEU.stand[Variable %in% c( "Emissions|CO2|||Industry") & Scenario %in% c("EU9")], aes(x=Year, y=ByY, colour=Study, group=Model) ) +
geom_hline(yintercept=100, linetype=2) +
geom_line(data=EIAETP2017[!Scenario=="BL" & Variable %in% c( "Emissions|CO2|||Industry")], aes(x=Year, y=ByY, colour=Study, group=Scenario) ) +
#geom_line(data=EIAETP2017, aes(x=Year, y=ByX, colour=Study, group=Scenario), size=1, linetype=2 ) +
geom_line(data=ADAM[!Scenario=="BL" & Variable %in% c( "Emissions|CO2|||Industry")], aes(x=Year, y=ByY, colour=Study, group=Scenario) ) +
#geom_line(data=ADAM, aes(x=Year, y=ByX, colour=Study, group=Scenario), size=1, linetype=2 ) +
geom_line(data=Fragosdatacalc[!Scenario=="BL" & Variable %in% c( "Emissions|CO2|||Industry")], aes(x=Year, y=ByY, colour=Study, group=Scenario)) +
#geom_line(data=Fragosdatacalc, aes(x=Year, y=ByX, colour=Study, group=Scenario), size=1, linetype=2 ) +
geom_line(data=IMAGEFINECO2calc[Variable %in% c( "Emissions|CO2|||Industry")], aes(x=Year.x, y=INDEX, group=Scenario, linetype=Scenario, colour=Study)) +
geom_line(data=IMAGEFINECO2calc[Variable %in% c( "Emissions|CO2|||Industry")], aes(x=Year.x, y=INDEX, group=Scenario, linetype=Scenario, colour=Study), size=1.5, colour="black") +
facet_wrap(~Variable, ncol=2, labeller= change) +
coord_cartesian(xlim=c(2005:2050), ylim=c(0:150)) +
theme_bw() +
ggtitle("Industry decarbonisation trajectories") +
labs(y="Index (2015=100) ", x = "Year") +
guides(fill=guide_legend("Sector"))+
scale_colour_manual(values=c('#d7191c','#fdae61', '#000000','#abd9e9','#2c7bb6'),
breaks=c("Förster et al. (2013)", "Fragkos et al. (2017)", "OECD/IEA (2017b)", "Schade et al. (2009)", "IMAGE")
) +
GROBTHEME
print(IEATOTDEMFUTy2005IMAGECO2)
# a grob in a grob in a grob
LITREVIEW_CO2 <-arrangeGrob(
arrangeGrob(INDTEELemisby +theme(legend.position="none",
plot.title = element_blank()),
INDCHEMemisby+theme(legend.position="none",
plot.title = element_blank()),
nrow=1,
widths = c(2,2) ),
arrangeGrob(
INDPPIemisby+theme(legend.position="none",
plot.title = element_blank()),
INDFOODemisby+theme(legend.position="none",
plot.title = element_blank()),
nrow=1,
widths = c(2,2) ),
ncol=1,
bottom=NULL,
#left=textGrob("Index (2010 = 100)", vjust = 0.5, rot=90, gp=gpar(fontsize=14)) ,
heights=c(4,4))
grid.newpage()
grid.draw(LITREVIEW_CO2)
dev.off()
setwd("/mnt/scratch/sluisveldvm/sluisveldvm/R/REINVENT/DEVELOPMENT")
png("Scenarios/figures/ALL_LITERATURE_REVIEW_CO2_industry.png", width=700, height=700)
grid.newpage()
grid.draw(LITREVIEW_CO2)
grid.newpage()
grid.draw(LITREVIEW_CO2)
#D4.2
INDFOODemisbyTwitter=ggplot() +
geom_hline(yintercept=100, linetype=2) +
#IMAGE
geom_line(data=CO2indexcalc[Variable %in% c( "Food") & Region %in% c("EU28") & Scenario %in% c("2 Degrees", "1.5 Degrees") ], aes(x=Year.x, y=INDEX, group=Scenario, linetype=Scenario, colour=Study), size=1)+
scale_colour_manual(values=c("#a5ae64","#4bbff2")) +
facet_wrap(~Variable, ncol=1) +
coord_cartesian(xlim=c(2005:2050), ylim=c(0:150)) +
theme_bw() +
ggtitle(bquote(bold("Total"~CO[2]~"emissions"))) +
labs(y="Index (2010=100) ", x = "Year") +
guides(fill=guide_legend("Sector"))+
GROBTHEME
print(INDFOODemisbyTwitter)
INDCHEMemisbyTwitter=ggplot() +
geom_hline(yintercept=100, linetype=2) +
geom_hline(yintercept = 0, linetype=1, alpha=0.4) +
#IMAGE
geom_line(data=CO2indexcalc[Variable %in% c( "Chemical") & Region %in% c("EU28") & Scenario %in% c("2 Degrees", "1.5 Degrees") ], aes(x=Year.x, y=INDEX, group=Scenario, linetype=Scenario, colour=Study), size=1)+
# WISEE
geom_line(data=WISEECO2share[Sector=="Chemical" & Variable=="Emissions|CO2"], aes(x=Year.x, y=Index, group=Scenario, linetype=Scenario, colour=Study), size=1) +
facet_wrap(~Sector, ncol=1) +
coord_cartesian(xlim=c(2005:2050), ylim=c(0:150)) +
theme_bw() +
ggtitle(bquote(bold("Total"~CO[2]~"emissions"))) +
labs(y="Index (2010=100) ", x = "Year") +
guides(fill=guide_legend("Sector"))+
scale_colour_manual(values=c("#a5ae64","#4bbff2")) +
scale_linetype_manual(values=c(6,1,6,1)) +
GROBTHEME
print(INDCHEMemisbyTwitter)
