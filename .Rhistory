if(!require(tidytext)){install.packages("tidytext");  library(tidytext)}
if(!require(tm)){install.packages("tm");  library(tm)}
if(!require(readxl)){install.packages("readxl");  library(readxl)}
if(!require(tabulizer)){install.packages("tabulizer");  library(tabulizer)}
# maps
if(!require(grid)){install.packages("grid"); library(grid)}
if(!require(rworldmap)){install.packages("rworldmap");  library(rworldmap)}
if(!require(geosphere)){install.packages("geosphere"); library(geosphere)}
if(!require(gpclib)){install.packages("gpclib"); library(gpclib)}
# data visualisation packages
if(!require(ggplot2)){install.packages("ggplot2");  library(ggplot2)}
if(!require(ggforce)){install.packages("ggforce");  library(ggforce)}
if(!require(plotly)){install.packages("plotly");  library(plotly)}
if(!require(paletteer)){install.packages("paletteer");  library(paletteer)}
if(!require(ggrepel)){install.packages("ggrepel");  library(ggrepel)}
if(!require(igraph)){install.packages("igraph");  library(igraph)}
if(!require(ggraph)){install.packages("ggraph");  library(ggraph)}
if(!require(ggforce)){install.packages("ggforce");  library(ggforce)}
if(!require(shadowtext)){install.packages("shadowtext");  library(shadowtext)}
if(!require(gt)){install.packages("gt");  library(gt)}
#if(!require(animation)){install.packages("animation");  library(animation)}
SCEN_xlsx <-list.files(path = "../../../../../harmensytze/Projects/REINVENT/7_Reporting_Tool/outxlsx/")
SCENSdat_list <- lapply(SCEN_xlsx, function(x){
dat <- read_xlsx(path=paste("../../../../../harmensytze/Projects/REINVENT/7_Reporting_Tool/outxlsx/", x, sep=""))
dat$Scenario <- x
dat=data.table(dat)
})
SCENdat <- rbindlist(SCENSdat_list, fill=TRUE) %>%
drop_na(Model) %>%
gather(Year, value, -c(Model, Scenario, Region, Variable, Unit)) %>%
mutate(Year=as.numeric(Year), value=as.numeric(value)) %>%
mutate(Scenario=gsub(".xlsx", "", Scenario, fixed=T)) %>%
drop_na(Year) %>%
bind_rows({.} %>% filter(Region %in% c("WEU", "CEU")) %>%
group_by(Model, Scenario, Variable, Unit, Year) %>%
summarise(value=sum(value)) %>%
mutate(Region="EU")) %>%
filter(!Region == "World") %>%
bind_rows({.} %>% filter(!Region %in% c( "EU")) %>%
group_by(Model, Scenario, Variable, Unit, Year) %>%
summarise(value=sum(value)) %>%
mutate(Region="World"))
SCENINDUS <- SCENdat %>%
filter(grepl("industry", tolower(Variable), fixed=T))
interpolate <- function(df, startyear, endyear){
df.intrapolate=seq(unique(df$Year)[1],endyear)
## Activate data.table package ###
dfreal=data.table(df)
#Intrapolatie with approximate
dfreal = dfreal[,list(approx(x=Year,y=value,xout=df.intrapolate)$y,
approx(x=Year,y=value,xout=df.intrapolate)$x),
by=eval(dput(names(dfreal[, -c("Year", "value")])))]
setnames(dfreal,"V1","value")
setnames(dfreal,"V2","Year")
dfreal=data.table(dfreal)
}
scenario_auth(token = drive_auth())
sheets_auth(token = drive_auth())
# Social Media analysis
if(!require(rtweet)){install.packages("rtweet");  library(rtweet)}
if(!require(trendyy)){install.packages("trendyy");  library(trendyy)}
if(!require(gtrendsR)){install.packages("gtrendsR");  library(gtrendsR)}
# API reading and online toolng
if(!require(googledrive)){install.packages("googledrive");  library(googledrive)}
if(!require(googlesheets4)){install_github("tidyverse/googlesheets4");  library(googlesheets4)}
if(!require(rscopus)){install.packages("rscopus");  library(rscopus)}
if(!require(orcid)){install.packages("orcid");  library(orcid)}
#if(!require(orcid)){install.packages("orcid");  library(orcid)}
if(!require(scholar)){install.packages("scholar");  library(scholar)}
sheets_auth(token = drive_auth())
drive_auth()
drive_auth()
SCENASSUMPTIONS <- read_xlsx("Scenario_assumptions.xlsx")
setwd("~/disks/y/Kennisbasis/IMAGE/model/users/mariesse/R/GitHub/marieyesse.github.io-master/marieyesse.github.io")
SCENASSUMPTIONS <- read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx")
head(SCENASSUMPTIONS)
SCENASSUMPTIONS <- read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx")%>%
mutate_all(make.names)
head(SCENASSUMPTIONS)
head(SCENASSUMPTIONS)
SCENASSUMPTIONS <- read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx")%>%
mutate_at(make.names)
SCENASSUMPTIONS <- read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx")%>%
mutate_all(make.names)
head(SCENASSUMPTIONS)
SCENASSUMPTIONS <- read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx")
head(SCENASSUMPTIONS)
SCENASSUMPTIONS <- read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
mutate_all(make.names)
head(SCENASSUMPTIONS)
SCENASSUMPTIONS <- read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
mutate(make.names)
SCENASSUMPTIONS <- read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
rename_all(make.names)
head(SCENASSUMPTIONS)
read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
rename_all(make.names) %>%
gt(
rowname_col = "Sector",
groupname_col = "Scenario"
) %>%
tab_header(title = "Scenario assumptions") %>%
tab_spanner(
#label = "Total Population",
columns = vars(`Change.relative.to.SSP2`, `Starting.from`, `Convergence.to.year`)
) %>%
fmt(
columns = vars(`Change.relative.to.SSP2`, `Starting.from`, `Convergence.to.year`),
)
read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
rename_all(make.names) %>%
gt(
rowname_col = "Sector",
groupname_col = "Scenario"
) %>%
tab_header(title = "Scenario assumptions") %>%
tab_spanner(
label = "Changes to SSP2",
columns = vars(`Change.relative.to.SSP2`, `Starting.from`, `Convergence.to.year`)
) %>%
fmt(
columns = vars(`Change.relative.to.SSP2`, `Starting.from`, `Convergence.to.year`),
)
?fmt_markdown
read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
rename_all(make.names) %>%
gt(
rowname_col = "Sector",
groupname_col = "Scenario"
) %>%
tab_header(title = "Scenario assumptions") %>%
tab_spanner(
label = "Changes to SSP2",
columns = vars(`Change.relative.to.SSP2`, `Starting.from`, `Convergence.to.year`)
) %>%
fmt_markdown(
columns = vars(`Change.relative.to.SSP2`, `Starting.from`, `Convergence.to.year`)
)
read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
filter(Scenario=="TechReplace") %>%
rename_all(make.names) %>%
select(Focus, Sector, What, Starting.from, Convergence.to.year, Reference) %>%
gt(
rowname_col = "Focus",
groupname_col = "Sector"
) %>%
tab_header(title = "Scenario assumptions") %>%
tab_spanner(
label = "Changes to SSP2",
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
fmt_markdown(
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
tab_options(table.font.size = 10,
row_group.background.color = "#FEFEFE",
table.width = pct(100),
column_labels.font.weight = "bold" )
read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
filter(Scenario=="TechReplace") %>%
rename_all(make.names) %>%
select(Focus, Sector, What, Starting.from, Convergence.to.year, Reference) %>%
gt(
rowname_col = "Focus",
groupname_col = "Sector"
) %>%
tab_header(title = "Scenario assumptions") %>%
tab_spanner(
label = "Changes to SSP2",
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
fmt_markdown(
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
tab_options(table.font.size = 10,
row_group.background.color = "#CC000",
table.width = pct(100),
column_labels.font.weight = "bold" )
read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
filter(Scenario=="TechReplace") %>%
rename_all(make.names) %>%
select(Focus, Sector, What, Starting.from, Convergence.to.year, Reference) %>%
gt(
rowname_col = "Focus",
groupname_col = "Sector"
) %>%
tab_header(title = "Scenario assumptions") %>%
tab_spanner(
label = "Changes to SSP2",
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
fmt_markdown(
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
tab_options(table.font.size = 10,
row_group.background.color = "#CC0000",
table.width = pct(100),
column_labels.font.weight = "bold" )
read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
filter(Scenario=="TechReplace") %>%
rename_all(make.names) %>%
select(Focus, Sector, What, Starting.from, Convergence.to.year, Reference) %>%
gt(
rowname_col = "Focus",
groupname_col = "Sector"
) %>%
tab_header(title = "Scenario assumptions") %>%
tab_spanner(
label = "Changes to SSP2",
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
fmt_markdown(
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
tab_options(table.font.size = 12,
row_group.background.color = "#CC0000",
table.width = pct(100),
column_labels.font.weight = "bold" )
read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
filter(Scenario=="TechReplace") %>%
rename_all(make.names) %>%
select(Focus, Sector, What, Starting.from, Convergence.to.year, Reference) %>%
gt(
rowname_col = "Focus",
groupname_col = "Sector"
) %>%
tab_header(title = "Scenario assumptions") %>%
tab_spanner(
label = "Changes to SSP2",
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
fmt_markdown(
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
tab_options(table.font.size = 12,
row_group.background.color = "#EE0000",
table.width = pct(100),
column_labels.font.weight = "bold" )
read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
filter(Scenario=="TechReplace") %>%
rename_all(make.names) %>%
select(Focus, Sector, What, Starting.from, Convergence.to.year, Reference) %>%
gt(
rowname_col = "Focus",
groupname_col = "Sector"
) %>%
tab_header(title = "Scenario assumptions") %>%
tab_spanner(
label = "Changes to SSP2",
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
fmt_markdown(
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
tab_options(table.font.size = 12,
row_group.background.color = "#D3D3D3",
table.width = pct(100),
column_labels.font.weight = "bold" )
read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
filter(Scenario=="TechReplace") %>%
rename_all(make.names) %>%
select(Focus, Sector, What, Starting.from, Convergence.to.year, Reference) %>%
gt(
rowname_col = "Focus",
groupname_col = "Sector"
) %>%
tab_header(title = "Scenario assumptions") %>%
tab_spanner(
label = "Changes to SSP2",
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
fmt_markdown(
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
tab_options(table.font.size = 12,
row_group.background.color = "#D3D3D3",
row_group.font.size = 14,
row_group.font.weight = "bold",
table.width = pct(100),
column_labels.font.weight = "bold" )
read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
filter(Scenario=="TechReplace") %>%
rename_all(make.names) %>%
select(Focus, Sector, What, Starting.from, Convergence.to.year, Reference) %>%
gt(
rowname_col = "Focus",
groupname_col = "Sector"
) %>%
tab_header(title = "Scenario assumptions") %>%
tab_spanner(
label = "Changes to SSP2",
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
fmt_markdown(
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
tab_options(table.font.size = 12,
row_group.background.color = "#D3D3D3",
row_group.font.size = 14,
row_group.font.weight = "bold",
table.width = pct(100),
column_labels.font.weight = "bold",
heading.title.font.size = 16,
heading.title.font.weight = "bold",)
read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
filter(Scenario=="TechReplace") %>%
rename_all(make.names) %>%
select(Focus, Sector, What, Starting.from, Convergence.to.year, Reference) %>%
gt(
rowname_col = "Focus",
groupname_col = "Sector"
) %>%
tab_header(title = "Scenario assumptions") %>%
tab_spanner(
label = "Changes to SSP2",
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
fmt_markdown(
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
tab_options(table.font.size = 12,
row_group.background.color = "#D3D3D3",
row_group.font.size = 14,
row_group.font.weight = "bold",
table.width = pct(100),
column_labels.font.weight = "bold",
heading.title.font.size = 20,
heading.title.font.weight = "bold",)
read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
filter(Scenario=="TechReplace") %>%
rename_all(make.names) %>%
select(Focus, Sector, What, Starting.from, Convergence.to.year, Reference) %>%
gt(
rowname_col = "Focus",
groupname_col = "Sector"
) %>%
tab_header(title = "Scenario assumptions") %>%
tab_spanner(
label = "Changes to SSP2",
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
fmt_markdown(
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
tab_options(table.font.size = 12,
table.align = "center",
row_group.background.color = "#D3D3D3",
row_group.font.size = 14,
row_group.font.weight = "bold",
table.width = pct(100),
column_labels.font.weight = "bold",
heading.title.font.size = 20,
heading.title.font.weight = "bold",)
read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
filter(Scenario=="TechReplace") %>%
rename_all(make.names) %>%
select(Focus, Sector, What, Starting.from, Convergence.to.year, Reference) %>%
gt(
rowname_col = "Focus",
groupname_col = "Sector"
) %>%
tab_header(title = "Scenario assumptions") %>%
tab_spanner(
label = "Changes to SSP2",
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
fmt_markdown(
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
tab_options(table.font.size = 12,
table.align = 0.5,
row_group.background.color = "#D3D3D3",
row_group.font.size = 14,
row_group.font.weight = "bold",
table.width = pct(100),
column_labels.font.weight = "bold",
heading.title.font.size = 20,
heading.title.font.weight = "bold",)
read_xlsx("../../../REINVENT_D4_4/Scenario_assumptions.xlsx") %>%
data.table() %>%
filter(Scenario=="TechReplace") %>%
rename_all(make.names) %>%
select(Focus, Sector, What, Starting.from, Convergence.to.year, Reference) %>%
gt(
rowname_col = "Focus",
groupname_col = "Sector"
) %>%
tab_header(title = "Scenario assumptions") %>%
tab_spanner(
label = "Changes to SSP2",
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
fmt_markdown(
columns = vars(`What`, `Starting.from`, `Convergence.to.year`, `Reference`)
) %>%
tab_options(table.font.size = 12,
table.align = "center",
row_group.background.color = "#D3D3D3",
row_group.font.size = 14,
row_group.font.weight = "bold",
table.width = pct(100),
column_labels.font.weight = "bold",
heading.title.font.size = 20,
heading.title.font.weight = "bold",)
ECONCO2 <- SCENdat %>%
filter(grepl("Emissions|CO2", Variable, fixed=T))
ECONCO2Tot <-   ECONCO2 %>%
#filter(grepl("emissions", tolower(Variable), fixed=T)) %>%
filter(!grepl("Emissions|CO2|",Variable, fixed=T)) %>%
filter(Region=="EU" ) %>%
cemis(., 2010, 2100) %>%
ggplot()+
geom_line(aes(x=Year, y=value,  group=Scenario, colour=Scenario)) +
labs(title="Cumulative CO2 Emissions",
x="Year",
y="MtCO2/yr") +
facet_wrap(~ Variable, ncol=2) +
theme(axis.text.x = element_text(angle=45, hjust=1),
text = element_text(size=14))
ggplotly(ECONCO2Tot)
ECONCO2 %>%
#filter(grepl("emissions", tolower(Variable), fixed=T)) %>%
filter(!grepl("Emissions|CO2|",Variable, fixed=T)) %>%
filter(Region=="EU" ) %>%
cemis(., 2010, 2100)
ECONCO2Tot <-   ECONCO2 %>%
#filter(grepl("emissions", tolower(Variable), fixed=T)) %>%
filter(!grepl("Emissions|CO2|",Variable, fixed=T)) %>%
filter(Region=="EU" ) %>%
cemis(., 2010, 2100)
ECONCO2Tot
SCENCHEMProd <-   SCENCHEM %>%
#filter(grepl("production", tolower(Variable), fixed=T)) %>%
#separate(Variable, c("X", "Y", "Industry", "Material"), sep = "[|]") %>%
mutate(Variable=gsub("Production|Industry|Chemical|", "", Variable, fixed=T)) %>%
filter(Region=="EU" ) %>%
ggplot()+
geom_area(data=. %>% filter(!grepl("scrap", tolower(Material), fixed=T)), aes(x=Year, y=value, fill=Material), position="stack", colour="black") +
geom_area(data=. %>% filter(grepl("scrap", tolower(Material), fixed=T)), aes(x=Year, y=value, fill=Material), position="stack", colour="black") +
labs(title="Production",
x="Year",
y="GJ prod/Yr") +
facet_wrap(~ Scenario, ncol=2) +
theme(axis.text.x = element_text(angle=45, hjust=1),
text = element_text(size=14))
SCENCHEM <- SCENdat %>%
filter(grepl("Production|Industry|Chemical|", tolower(Variable), fixed=T))
SCENCHEMProd <-   SCENCHEM %>%
#filter(grepl("production", tolower(Variable), fixed=T)) %>%
#separate(Variable, c("X", "Y", "Industry", "Material"), sep = "[|]") %>%
mutate(Variable=gsub("Production|Industry|Chemical|", "", Variable, fixed=T)) %>%
filter(Region=="EU" ) %>%
ggplot()+
geom_area(data=. %>% filter(!grepl("scrap", tolower(Material), fixed=T)), aes(x=Year, y=value, fill=Material), position="stack", colour="black") +
geom_area(data=. %>% filter(grepl("scrap", tolower(Material), fixed=T)), aes(x=Year, y=value, fill=Material), position="stack", colour="black") +
labs(title="Production",
x="Year",
y="GJ prod/Yr") +
facet_wrap(~ Scenario, ncol=2) +
theme(axis.text.x = element_text(angle=45, hjust=1),
text = element_text(size=14))
ggplotly(SCENCHEMProd)
head(SCENCHEM)
SCENCHEM <- SCENdat %>%
filter(grepl("Production|Industry|Chemical|", Variable, fixed=T))
SCENCHEMProd <-   SCENCHEM %>%
#filter(grepl("production", tolower(Variable), fixed=T)) %>%
#separate(Variable, c("X", "Y", "Industry", "Material"), sep = "[|]") %>%
mutate(Variable=gsub("Production|Industry|Chemical|", "", Variable, fixed=T)) %>%
filter(Region=="EU" ) %>%
ggplot()+
geom_area(data=. %>% filter(!grepl("scrap", tolower(Material), fixed=T)), aes(x=Year, y=value, fill=Material), position="stack", colour="black") +
geom_area(data=. %>% filter(grepl("scrap", tolower(Material), fixed=T)), aes(x=Year, y=value, fill=Material), position="stack", colour="black") +
labs(title="Production",
x="Year",
y="GJ prod/Yr") +
facet_wrap(~ Scenario, ncol=2) +
theme(axis.text.x = element_text(angle=45, hjust=1),
text = element_text(size=14))
ggplotly(SCENCHEMProd)
SCENCHEMProd <-   SCENCHEM %>%
#filter(grepl("production", tolower(Variable), fixed=T)) %>%
#separate(Variable, c("X", "Y", "Industry", "Material"), sep = "[|]") %>%
mutate(Variable=gsub("Production|Industry|Chemical|", "", Variable, fixed=T)) %>%
filter(Region=="EU" ) %>%
ggplot()+
geom_area( aes(x=Year, y=value, fill=Variable), position="stack", colour="black") +
geom_area(aes(x=Year, y=value, fill=Variable), position="stack", colour="black") +
labs(title="Production",
x="Year",
y="GJ prod/Yr") +
facet_wrap(~ Scenario, ncol=2) +
theme(axis.text.x = element_text(angle=45, hjust=1),
text = element_text(size=14))
ggplotly(SCENCHEMProd)
