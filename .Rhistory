geom_bar(data=INDUSEMIS2015[Region %in% c("EU28") &  Year %in% c("2015") & Variable.y %in% c("Fossil Fuels and Industry|Energy Demand|Industry") & Variable.x %in% c("Iron and Steel|Direct emissions",
"Pulp and Paper|Direct emissions",
"Food Processing|Direct emissions",
"Chemicals and Petrochemicals|HVC|Direct emissions") &
Scenario=="2 Degrees"],
aes(x=as.factor(Year), y=Share, fill=Variable.x, group=Variable.x), colour="black",position="stack", stat="identity" ) +
#geom_text(data=IEAIND.26regshare1[Native.Region.Code %in% c("EU27") & Year=="2015" & Variable.x %in% c("CHEMICAL", "FOODPRO", "PAPERPRO", "IRONSTL") & TIMER_CARRIER=="Total"], aes(x=as.factor(Year), y=Share, label=round(Share)), position = "stack") +
#  facet_wrap(~Item, ncol=2, scales="free") +
theme_bw() +
coord_polar("y", start=0) +
ggtitle("Share of CO2 emissions in total emissions") +
labs(y=" ", x = "Year") +
guides(fill=guide_legend("Sector"))+
theme(
axis.text.x = element_text( size=11,hjust=0.5, face="bold"),
axis.title.y = element_blank(),
axis.title.x = element_text(size=13),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.x = element_text(size=10, face="bold"),
strip.text.y = element_text(size=10, face="bold"),
legend.text= element_text(),
legend.title=element_text(size=11,  face="bold", hjust=0.5),
plot.title=element_text(size=14, hjust=0.5, face="bold"),
plot.subtitle=element_blank(),
panel.border = element_blank(),
legend.key =  element_rect(fill = 'white', size = 0.5),
strip.background = element_rect(colour="white", fill="#FFFFFF"))+
scale_fill_manual(breaks = c(
"Iron and Steel|Direct emissions",
"Pulp and Paper|Direct emissions",
"Food Processing|Direct emissions",
"Chemicals and Petrochemicals|HVC|Direct emissions",
"Fossil Fuels and Industry|Energy Demand|Industry"
),
labels = c(  "Iron and Steel",
"Pulp and Paper",
"Food Processing",
"Plastics",
"Rest"
),
values=c('#2b83ba','#abdda4', '#ffffbf','#fdae61','#d7191c'))
print(IEASHARESPIEEmisindus)
############################################################################
################## PRODUCTION VOLUMES ######################################
## Import
############################################################################
# Requirements
# Plotting and transforming
setwd("/mnt/scratch/sluisveldvm/sluisveldvm/R/REINVENT/DEVELOPMENT/INDDEM/PAPER")
source(file="REINVENT_PAPERDEM_polynomial.R")                 ## Includes all necessary Libraries
setwd("/mnt/scratch/sluisveldvm/sluisveldvm/R/REINVENT/DEVELOPMENT/Scenarios")
##############################################################################
########################## Diff 1.5 and 2C
##############################################################################
####### Set working directory (all files should be in same level as script)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
setwd("E:/UU/R/REINVENT/DEVELOPMENT/Scenarios")
ALLVAR=data.table(ALLVAR)
DIFF1.5=ALLVAR[Scenario %in% c("2 Degrees", "1.5 Degrees", "Baseline")]
DIFF1.5=DIFF1.5[Variable %in% c(
"Final Energy|Transportation",
"Final Energy|Transportation|Electricity",
"Final Energy|Transportation|Gases",
"Final Energy|Transportation|Hydrogen",
"Final Energy|Transportation|Liquids|Biomass",
"Final Energy|Transportation|Liquids|Coal",
"Final Energy|Transportation|Liquids|Natural Gas",
"Final Energy|Transportation|Liquids|Oil",
"Final Energy|Transportation|Other",
"Final Energy|Residential and Commercial|Electricity",
"Final Energy|Residential and Commercial|Gases",
"Final Energy|Residential and Commercial|Hydrogen",
"Final Energy|Residential and Commercial|Liquids|Biomass",
"Final Energy|Residential and Commercial|Liquids|Oil",
"Final Energy|Residential and Commercial|Other",
"Final Energy|Residential and Commercial|Solids|Biomass",
"Final Energy|Residential and Commercial|Solids|Coal",
"Secondary Energy|Electricity",
"Secondary Energy|Electricity|Biomass|w/ CCS",
"Secondary Energy|Electricity|Biomass|w/o CCS",
"Secondary Energy|Electricity|Coal|w/ CCS",
"Secondary Energy|Electricity|Coal|w/o CCS",
"Secondary Energy|Electricity|Gas|w/ CCS",
"Secondary Energy|Electricity|Gas|w/o CCS",
"Secondary Energy|Electricity|Non-Biomass Renewables",
"Secondary Energy|Electricity|Hydro",
"Secondary Energy|Electricity|Solar",
"Secondary Energy|Electricity|Wind",
"Secondary Energy|Electricity|Nuclear",
"Secondary Energy|Electricity|Oil|w/ CCS",
"Secondary Energy|Electricity|Oil|w/o CCS",
"Secondary Energy|Electricity|Other",
"Final Energy|industry",
"Final Energy|industry|Electricity",
"Final Energy|industry|Gases",
"Final Energy|industry|Heat",
"Final Energy|industry|Hydrogen",
"Final Energy|industry|Liquids",
"Final Energy|industry|Solids|Biomass",
"Final Energy|industry|Solids|Coal"
)]
# Creating Sector categories (for easy facetting)
DIFF1.5split<- data.frame(do.call('rbind', strsplit(as.character(DIFF1.5$Variable),'|',fixed=TRUE)))
DIFF1.5merge=cbind(DIFF1.5, DIFF1.5split$X2)
setnames(DIFF1.5merge, "V2", "Sector")
# Cleaning and plotting
DIFF1.5merge$Variable <- gsub("Final Energy|industry|", "", DIFF1.5merge$Variable, fixed=TRUE)
DIFF1.5merge$Variable <- gsub("Secondary Energy|Electricity|", "", DIFF1.5merge$Variable, fixed=TRUE)
DIFF1.5merge$Variable <- gsub("Final Energy|Residential and Commercial|", "", DIFF1.5merge$Variable, fixed=TRUE)
DIFF1.5merge$Variable <- gsub("Final Energy|Transportation|", "", DIFF1.5merge$Variable, fixed=TRUE)
# 1.5 plots
DIFF1.5merge=data.table(DIFF1.5merge)
DIFF1.5merge=DIFF1.5merge[order(-Variable)]
DIFF1.5emis=ALLVAR[Scenario %in% c("2 Degrees", "1.5 Degrees", "Baseline")]
DIFF1.5emis=DIFF1.5emis[Variable %in% c(
# Emissions
"Emissions|Kyoto Gases",
"Emissions|CO2|Iron and Steel|Direct emissions",
"Emissions|CO2|Pulp and Paper|Direct emissions",
"Emissions|CO2|Fossil Fuels and Industry|Energy Demand|Industry",
"Emissions|CO2|Fossil Fuels and Industry|Energy Demand",
"Emissions|CO2|Fossil Fuels and Industry",
"Emissions|CO2|Fossil Fuels and Industry|Energy Demand",
"Emissions|CO2|Fossil Fuels and Industry|Energy Demand|Industry",
"Emissions|CO2|Fossil Fuels and Industry|Energy Demand|Other Sector",
"Emissions|CO2|Fossil Fuels and Industry|Energy Demand|Residential and Commercial",
"Emissions|CO2|Fossil Fuels and Industry|Energy Demand|Transportation",
"Emissions|CO2|Fossil Fuels and Industry|Energy Supply|Electricity",
"Emissions|CO2|Land Use",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Energy|Supply|Electricity",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Energy|Demand|Industry",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Energy|Supply|Electricity",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Energy|Demand|Industry",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Industrial Processes|Pulp and Paper",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Industrial Processes|Pulp and Paper",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Industrial Processes|Iron and Steel",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Industrial Processes|Iron and Steel",
"Emissions|CO2|Chemicals and Petrochemicals|Direct emissions",
"Emissions|CO2|Chemicals and Petrochemicals|HVC|Direct emissions",
"Emissions|CO2|Food Processing|Direct emissions"
)]
DIFF1.5emis$Variable <- gsub("Emissions|CO2|Fossil Fuels and Industry|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Emissions|CO2|Carbon Capture and Storage|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Energy|Supply|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Energy|Demand|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Energy Demand|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Energy Supply|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Emissions|CO2|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Emissions|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Emissions|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("|Direct emissions", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Industrial Processes|", "", DIFF1.5emis$Variable, fixed=TRUE)
setnames(DIFF1.5emis, "Year.x", "Year")
DIFF1.5emis=ALLVAR[Scenario %in% c("2 Degrees", "1.5 Degrees", "Baseline")]
DIFF1.5emis=DIFF1.5emis[Variable %in% c(
# Emissions
"Emissions|Kyoto Gases",
"Emissions|CO2|Iron and Steel|Direct emissions",
"Emissions|CO2|Cement|Direct emissions",
"Emissions|CO2|Pulp and Paper|Direct emissions",
"Emissions|CO2|Fossil Fuels and Industry|Energy Demand|Industry",
"Emissions|CO2|Fossil Fuels and Industry|Energy Demand",
"Emissions|CO2|Fossil Fuels and Industry",
"Emissions|CO2|Fossil Fuels and Industry|Energy Demand",
"Emissions|CO2|Fossil Fuels and Industry|Energy Demand|Industry",
"Emissions|CO2|Fossil Fuels and Industry|Energy Demand|Other Sector",
"Emissions|CO2|Fossil Fuels and Industry|Energy Demand|Residential and Commercial",
"Emissions|CO2|Fossil Fuels and Industry|Energy Demand|Transportation",
"Emissions|CO2|Fossil Fuels and Industry|Energy Supply|Electricity",
"Emissions|CO2|Land Use",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Energy|Supply|Electricity",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Energy|Demand|Industry",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Energy|Supply|Electricity",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Energy|Demand|Industry",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Industrial Processes|Pulp and Paper",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Industrial Processes|Pulp and Paper",
"Emissions|CO2|Carbon Capture and Storage|Biomass|Industrial Processes|Iron and Steel",
"Emissions|CO2|Carbon Capture and Storage|Fossil|Industrial Processes|Iron and Steel",
"Emissions|CO2|Chemicals and Petrochemicals|Direct emissions",
"Emissions|CO2|Chemicals and Petrochemicals|HVC|Direct emissions",
"Emissions|CO2|Food Processing|Direct emissions"
)]
DIFF1.5emis$Variable <- gsub("Emissions|CO2|Fossil Fuels and Industry|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Emissions|CO2|Carbon Capture and Storage|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Energy|Supply|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Energy|Demand|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Energy Demand|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Energy Supply|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Emissions|CO2|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Emissions|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Emissions|", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("|Direct emissions", "", DIFF1.5emis$Variable, fixed=TRUE)
DIFF1.5emis$Variable <- gsub("Industrial Processes|", "", DIFF1.5emis$Variable, fixed=TRUE)
setnames(DIFF1.5emis, "Year.x", "Year")
#### WISEE MODEL DATA
setwd("/mnt/scratch/sluisveldvm/sluisveldvm/R/REINVENT/DEVELOPMENT/Scenarios")
WISEECO2_0= read.csv("WISEE_CO2_emissions_22_6_2018.csv", sep=";", dec=",")
WISEECO2=melt(WISEECO2_0,  id.vars=c("Model", "Variable","Sector","Scenario"), variable.name="Year")
WISEECO2$Year = as.numeric(as.character(substr(WISEECO2$Year, 2, stop=100)))
WISEECO2_0= read.csv("WISEE_CO2_emissions_22_6_2018.csv", sep=";", dec=",")
WISEECO2=melt(WISEECO2_0,  id.vars=c("Model", "Variable","Sector","Scenario"), variable.name="Year")
WISEECO2$Year = as.numeric(as.character(substr(WISEECO2$Year, 2, stop=100)))
WISEECO2$value = as.numeric(WISEECO2$value)
#WISEECO2 <- na.omit(WISEECO2)
WISEECO2=data.table(WISEECO2)
WISEECO2=WISEECO2[Variable=="Emissions|CO2"]
WISEECO2$Variable <- NULL
WISEECO2$Unit <- "Mt/yr"
setnames(WISEECO2, "Sector", "Variable")
WISEECO2$Region <- "EU28"
DIFF1.5emis=rbind(DIFF1.5emis, WISEECO2)
### GGPLOT WISEE/IMAGE
### Per sector emission pathways
WISEE_IMAGEPPI=ggplot(data=DIFF1.5emis[Variable %in% c("Pulp and Paper"
) & !Scenario%in% c("Baseline") & Region=="EU28"])+
geom_line(
aes(x=Year, y=value, group=Scenario, colour=Model, linetype=Scenario), size=1)+
geom_hline(yintercept=0, linetype=2) +
xlab("Year") + ylab(bquote("Mt"~CO[2]*"/yr")) + ggtitle(bquote(bold(CO[2]~"emissions"))) +
coord_cartesian(xlim = c(2015:2050), ylim=c(-50:40))  +
facet_wrap(~Variable, scales="free", ncol=2) +
scale_colour_manual(values=c('#d7191c','#2c7bb6')) +
scale_linetype_manual(values=c(1,4,1,4))+
GROBTHEME
print(WISEE_IMAGEPPI)
png("figures/WISEE_IMAGEPPI_CO2.png", width=500, height=400)
print(WISEE_IMAGEPPI)
CEMIS=DIFF1.5emis
CEMIS.intrapolate=seq(unique(DIFF1.5emis$Year.x)[1],2100) #unique(sdt$Year)[length(unique(sdt$Year))]
## Activate data.table package ###
CEMISreal=data.table(CEMIS)
#Intrapolatie with approximate
CEMISreal = CEMISreal[,list(approx(x=Year.x,y=value.x,xout=CEMIS.intrapolate)$y,approx(x=Year.x,y=value.x,xout=CEMIS.intrapolate)$x),by=c('Model','Scenario','Region','Variable', "Unit")]
setnames(CEMISreal,"V1","value")
setnames(CEMISreal,"V2","Year")
## sommering
CEMISrealsum10=CEMISreal[Year %in% c(2010),sum(value,na.rm=TRUE),by=c('Model','Scenario','Region','Variable', "Unit")]
CEMISrealsum10$Year <- "2010"
CEMISrealsum20=CEMISreal[Year %in% c(2010:2020),sum(value,na.rm=TRUE),by=c('Model','Scenario','Region','Variable', "Unit")]
CEMISrealsum20$Year <- "2020"
CEMISrealsum30=CEMISreal[Year %in% c(2010:2030),sum(value,na.rm=TRUE),by=c('Model','Scenario','Region','Variable', "Unit")]
CEMISrealsum30$Year <- "2030"
CEMISrealsum40=CEMISreal[Year %in% c(2010:2040),sum(value,na.rm=TRUE),by=c('Model','Scenario','Region','Variable', "Unit")]
CEMISrealsum40$Year <- "2040"
CEMISrealsum50=CEMISreal[Year %in% c(2010:2050),sum(value,na.rm=TRUE),by=c('Model','Scenario','Region','Variable', "Unit")]
CEMISrealsum50$Year <- "2050"
CEMISrealsum60=CEMISreal[Year %in% c(2010:2060),sum(value,na.rm=TRUE),by=c('Model','Scenario','Region','Variable', "Unit")]
CEMISrealsum60$Year <- "2060"
CEMISrealsum70=CEMISreal[Year %in% c(2010:2070),sum(value,na.rm=TRUE),by=c('Model','Scenario','Region','Variable', "Unit")]
CEMISrealsum70$Year <- "2070"
CEMISrealsum80=CEMISreal[Year %in% c(2010:2080),sum(value,na.rm=TRUE),by=c('Model','Scenario','Region','Variable', "Unit")]
CEMISrealsum80$Year <- "2080"
CEMISrealsum90=CEMISreal[Year %in% c(2010:2090),sum(value,na.rm=TRUE),by=c('Model','Scenario','Region','Variable', "Unit")]
CEMISrealsum90$Year <- "2090"
CEMISrealsum100=CEMISreal[Year %in% c(2010:2100),sum(value,na.rm=TRUE),by=c('Model','Scenario','Region','Variable', "Unit")]
CEMISrealsum100$Year <- "2100"
CEMISrealsum = rbind(CEMISrealsum10,CEMISrealsum20,CEMISrealsum30,CEMISrealsum40,CEMISrealsum50,CEMISrealsum60,CEMISrealsum70,CEMISrealsum80,CEMISrealsum90,CEMISrealsum100)
setnames(CEMISrealsum,"V1","value")
# Start counting from 2010 onwards
CEMISrealsumcor=merge(CEMISrealsum, CEMISrealsum10,by=c('Model','Scenario','Region','Variable', "Unit") )
CEMISrealsumcor=CEMISrealsumcor %>% mutate(valuecor=(value - V1))
CEMISrealsumcor=data.table(CEMISrealsumcor)
CEMISrealsumcor=CEMISrealsumcor[, !c("value", "V1", "Year.y")]
setnames(CEMISrealsumcor, "Year.x", "Year")
setnames(CEMISrealsumcor, "valuecor", "value")
#
write.table(CEMISrealsumcor[Region %in% c("World", "EU28", "WEU", "CEU")], "datatables/cumulative_emissions.csv", sep=";", dec=".", row.names=FALSE)
##########################################
### Offsetting
CEMISrealsumcorbase=CEMISrealsumcor[Scenario=="Baseline"]
CEMISrealsumcormerge=merge(CEMISrealsumcor, CEMISrealsumcorbase, by=c("Model", "Variable", "Region", "Unit", "Year") )
CEMISrealsumcormutate= CEMISrealsumcormerge %>% mutate(Diff=(value.y-value.x))
CEMISrealsumcormutate=data.table(CEMISrealsumcormutate)
setnames(CEMISrealsumcormutate, "Scenario.x", "Scenario")
CEMISrealsumcormutate$Region<- factor(CEMISrealsumcormutate$Region, levels=c( "EU28", "BRA","CAN","CHN","INDIA","JAP", "USA" ))
CEMISrealsum$Region<- factor(CEMISrealsum$Region, levels=c( "EU28", "BRA","CAN","CHN","INDIA","JAP", "USA" ))
### Per CO2 captured vs emitted
#"Industry", "Electricity", "Transportation", "Residential and Commercial"
# "Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing"
CUMUOFFSET=ggplot()+
geom_bar(data=CEMISrealsumcormutate[Variable %in% c("Biomass|Electricity","Biomass|Industry","Fossil|Industry","Fossil|Electricity") & Year %in% c("2030", "2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline" ], aes(x=Region, y=Diff, fill=Variable), stat="identity", position="stack", colour="black")+
annotate("rect", xmin=-Inf,xmax=Inf,ymin=0,ymax=Inf, fill="lightgrey") +
annotate("rect", xmin=-Inf,xmax=Inf,ymin=-Inf,ymax=0, fill="lightblue") +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8,y=-36000, label="CO[2]~Captured", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=0) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8,y=56000, label="CO[2]~emitted", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=1) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
geom_bar(data=CEMISrealsumcormutate[Variable %in% c("Biomass|Electricity","Biomass|Industry","Fossil|Industry","Fossil|Electricity") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=Diff, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Variable %in% c("Industry", "Electricity", "Transportation", "Residential and Commercial") & Year %in% c("2030","2050") & Region %in% c("EU28", "JAP","CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"& value >= 0], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Mt"~CO[2])) + ggtitle(bquote(bold("Cumulative emitted and captured"~CO[2]~"emissions since 2015"))) +
coord_flip(ylim = c(-35000:55000))+
facet_grid(Year~Scenario, scales="free") +
GROBTHEME +
guides(fill=guide_legend( title="Emissions sink or source",ncol=2, title.position="top", title.hjust = 0)) +
theme(legend.position="bottom") +
scale_fill_manual(breaks=c("Biomass|Electricity", "Biomass|Industry", "Fossil|Electricity", "Fossil|Industry", "Fossil Fuels and Industry", "Industry", "Electricity", "Transportation", "Residential and Commercial"),
labels=c("BECCS (power sector)", "BECCS (Industry)", "CCS (Power Sector)", "CCS (Industry)", "Emissions whole economy", "Industry", "Electricity", "Transportation", "Residential and Commercial"),
values=c('#edf8fb','#b2e2e2','grey','#2ca25f','#006d2c', '#e66101','#fdb863','#c2a5cf','#7b3294'))
print(CUMUOFFSET)
png("figures/Cumu_emis_emit_captured_regions.png", width=600, height=600)
print(CUMUOFFSET)
dev.off()
ggsave("figures/Cumu_emis_emitcaptured_regions.pdf", width=7, height=5, unit="in")
CUMUOFFSETworld=ggplot()+
geom_bar(data=CEMISrealsumcormutate[Variable %in% c("Biomass|Electricity","Biomass|Industry","Fossil|Industry","Fossil|Electricity") & Year %in% c("2030","2050", "2100") & Region %in% c("World") & !Scenario=="Baseline" ], aes(x=as.factor(Year), y=Diff/1000, fill=Variable), stat="identity", position="stack", colour="black")+
annotate("rect", xmin=-Inf,xmax=Inf,ymin=0,ymax=Inf, fill="lightgrey") +
annotate("rect", xmin=-Inf,xmax=Inf,ymin=-Inf,ymax=0, fill="lightblue") +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8,y=-176, label="CO[2]~Captured", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=0) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8,y=236, label="CO[2]~emitted", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=1) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
geom_bar(data=CEMISrealsumcormutate[Variable %in% c("Biomass|Electricity","Biomass|Industry","Fossil|Industry","Fossil|Electricity") & Year %in% c("2030","2050","2100") & Region %in% c("World") & !Scenario=="Baseline"], aes(x=as.factor(Year), y=Diff/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Variable %in% c("Industry", "Electricity", "Transportation", "Residential and Commercial") & Year %in% c("2030","2050","2100") & Region %in% c("World") & !Scenario=="Baseline"& value >= 0], aes(x=as.factor(Year), y=value/1000, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Year") + ylab(bquote("Budget (Gt"~CO[2]*")")) + ggtitle(bquote(bold("Cumulative emitted and captured"~CO[2]~"emissions since 2010"))) +
coord_flip(ylim=c(-185:230))+
facet_grid(~Scenario, scales="free") +
GROBTHEME +
guides(fill=guide_legend( title="Emissions sink or source",ncol=2, title.position="top", title.hjust = 0)) +
theme(legend.position="bottom") +
scale_fill_manual(breaks=c("Biomass|Electricity", "Biomass|Industry", "Fossil|Electricity", "Fossil|Industry", "Fossil Fuels and Industry", "Industry", "Electricity", "Transportation", "Residential and Commercial"),
labels=c("BECCS (power sector)", "BECCS (Industry)", "CCS (Power Sector)", "CCS (Industry)", "Emissions whole economy", "Industry", "Electricity", "Transportation", "Residential and Commercial"),
values=c('#edf8fb','#b2e2e2','grey','#2ca25f','#006d2c', '#e66101','#fdb863','#c2a5cf','#7b3294'))
print(CUMUOFFSETworld)
## Reordering does not work????
CEMISrealsumcormutate=CEMISrealsumcormutate[order(-Scenario)]
CEMISrealsumcormutate=data.table(CEMISrealsumcormutate)
CEMISrealsum=CEMISrealsum[order(-Scenario)]
CEMISrealsumcormutate$Scenario <- factor(CEMISrealsumcormutate$Scenario, levels=c("2 Degrees", "1.5 Degrees", "Baseline", "CIRC", "CCS"))
CEMISrealsum$Scenario <- factor(CEMISrealsum$Scenario, levels=c("2 Degrees", "1.5 Degrees", "Baseline", "CIRC", "CCS"))
CEMISrealsumcormutate$Region <- factor(CEMISrealsumcormutate$Region, levels=c("USA","JAP", "INDIA","CHN","CAN", "BRA", "EU28"))
CEMISrealsum$Region <- factor(CEMISrealsum$Region, levels=c("USA","JAP", "INDIA","CHN","CAN", "BRA", "EU28"))
fakeydata=data.table(Region=c(rep("USA", 6),rep("JAP", 6), rep("INDIA", 6),rep("CHN", 6), rep("CAN", 6),rep("BRA", 6),rep("EU28", 6)),
Variable=c(rep(c(" ", "  ", "   "),14)),
Year=c(rep(2030, 42)),
Scenario=c( rep(c("2 Degrees", "2 Degrees", "2 Degrees","1.5 Degrees", "1.5 Degrees", "1.5 Degrees"),7)),
value=c(rep(0, 42)))
fakeydata2=data.table(Region=c(rep("USA", 6),rep("JAP", 6), rep("INDIA", 6),rep("CHN", 6), rep("CAN", 6),rep("BRA", 6),rep("EU28", 6)),
Variable=c(rep(c(" ", "  ", "   "),14)),
Year=c(rep(2050, 42)),
Scenario=c( rep(c("2 Degrees", "2 Degrees", "2 Degrees","1.5 Degrees", "1.5 Degrees", "1.5 Degrees"),7)),
value=c(rep(0, 42)))
fakeydata=rbind(fakeydata, fakeydata2)
fakeydata$Scenario <- factor(fakeydata$Scenario, levels=c("2 Degrees", "1.5 Degrees"))
fakeydata$Region<- factor(fakeydata$Region, levels=c( "EU28", "BRA","CAN","CHN","INDIA","JAP", "USA" ))
CUMUOFFSETindus=ggplot()+
geom_bar(data=fakeydata, aes(x=Region, y=value, fill=Variable), stat="identity", position="stack")+
geom_bar(data=CEMISrealsumcormutate[Model %in% c("IMAGE") & Variable %in% c("Biomass|Industry","Fossil|Industry") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=Diff, fill=Variable), stat="identity", position="stack", colour="black")+
annotate("rect", xmin=-Inf,xmax=Inf,ymin=0,ymax=Inf, fill="lightgrey") +
annotate("rect", xmin=-Inf,xmax=Inf,ymin=-Inf,ymax=0, fill="lightblue") +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8,y=-8900, label="CO[2]~Captured", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=0) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8,y=22500, label="CO[2]~emitted", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=1) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
# # "Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing"
geom_bar(data=CEMISrealsumcormutate[Model %in% c("IMAGE") & Variable %in% c("Biomass|Industry","Fossil|Industry") & Year %in% c("2030","2050") & Region %in% c("EU28", "JAP","CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=Diff, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Industry") & Year %in% c("2030","2050") & Region %in% c("EU28", "JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Pulp and Paper") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario %in% c("Baseline", "1.5 Degrees")], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals",  "Cement", "Food Processing") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Mt"~CO[2])) + ggtitle(bquote(bold("Cumulative emitted and captured"~CO[2]~"emissions since 2015"))) +
coord_flip(ylim = c(-8000:22000))+
facet_grid(Year~Scenario, scales="free") +
GROBTHEME +
guides(fill=guide_legend( title="Emissions sink or source",ncol=2, title.position="top", title.hjust = 0.5, override.aes=list(colour=NA))) +
theme(legend.position="bottom",
legend.key = element_rect(colour="white")) +
scale_fill_manual(breaks=c( "Biomass|Industry",  "Fossil|Industry", " ", "  ", "   ", "Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", "Industry"),
labels=c("BECCS (Industry)", "CCS (Industry)",  " ", "  ", "   ", "Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", "Other industries (non-REINVENT)"),
values=c('#FFFFFF', '#FFFFFF', '#FFFFFF','#B2E2E2','#E66101','#5A00FF','#2ca25f','grey40', '#fdb863','#c2a5cf','#7b3294'))
CUMUOFFSETindus=ggplot()+
geom_bar(data=fakeydata, aes(x=Region, y=value, fill=Variable), stat="identity", position="stack")+
geom_bar(data=CEMISrealsumcormutate[Model %in% c("IMAGE") & Variable %in% c("Biomass|Industry","Fossil|Industry") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=Diff, fill=Variable), stat="identity", position="stack", colour="black")+
annotate("rect", xmin=-Inf,xmax=Inf,ymin=0,ymax=Inf, fill="lightgrey") +
annotate("rect", xmin=-Inf,xmax=Inf,ymin=-Inf,ymax=0, fill="lightblue") +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8,y=-8900, label="CO[2]~Captured", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=0) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8,y=22500, label="CO[2]~emitted", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=1) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
# # "Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing"
geom_bar(data=CEMISrealsumcormutate[Model %in% c("IMAGE") & Variable %in% c("Biomass|Industry","Fossil|Industry") & Year %in% c("2030","2050") & Region %in% c("EU28", "JAP","CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=Diff, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Industry") & Year %in% c("2030","2050") & Region %in% c("EU28", "JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Pulp and Paper") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario %in% c("Baseline", "1.5 Degrees")], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals",  "Cement", "Food Processing") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Mt"~CO[2])) + ggtitle(bquote(bold("Cumulative emitted and captured"~CO[2]~"emissions since 2015"))) +
coord_flip(ylim = c(-8000:22000))+
facet_grid(Year~Scenario, scales="free") +
GROBTHEME +
guides(fill=guide_legend( title="Emissions sink or source",ncol=2, title.position="top", title.hjust = 0.5, override.aes=list(colour=NA))) +
theme(legend.position="bottom",
legend.key = element_rect(colour="white")) +
scale_fill_manual(breaks=c( "Biomass|Industry",  "Fossil|Industry", " ", "  ", "   ", "Iron and Steel", "Cement", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", "Industry"),
labels=c("BECCS (Industry)", "CCS (Industry)",  " ", "  ", "   ", "Iron and Steel","Cement",  "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", "Other industries (non-REINVENT)"),
values=c('#FFFFFF', '#FFFFFF', '#FFFFFF','#B2E2E2', "red",'#E66101','#5A00FF','#2ca25f','grey40', '#fdb863','#c2a5cf','#7b3294'))
print(CUMUOFFSETindus)
print(CUMUOFFSETindus)
CUMUOFFSETindus=ggplot()+
geom_bar(data=fakeydata, aes(x=Region, y=value, fill=Variable), stat="identity", position="stack")+
geom_bar(data=CEMISrealsumcormutate[Model %in% c("IMAGE") & Variable %in% c("Biomass|Industry","Fossil|Industry") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=Diff, fill=Variable), stat="identity", position="stack", colour="black")+
annotate("rect", xmin=-Inf,xmax=Inf,ymin=0,ymax=Inf, fill="lightgrey") +
annotate("rect", xmin=-Inf,xmax=Inf,ymin=-Inf,ymax=0, fill="lightblue") +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8,y=-8900, label="CO[2]~Captured", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=0) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8,y=22500, label="CO[2]~emitted", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=1) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
# # "Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing"
geom_bar(data=CEMISrealsumcormutate[Model %in% c("IMAGE") & Variable %in% c("Biomass|Industry","Fossil|Industry") & Year %in% c("2030","2050") & Region %in% c("EU28", "JAP","CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=Diff, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Industry") & Year %in% c("2030","2050") & Region %in% c("EU28", "JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Pulp and Paper") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario %in% c("Baseline", "1.5 Degrees")], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals",  "Cement", "Food Processing") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Mt"~CO[2])) + ggtitle(bquote(bold("Cumulative emitted and captured"~CO[2]~"emissions since 2015"))) +
coord_flip(ylim = c(-8000:22000))+
facet_grid(Year~Scenario, scales="free") +
GROBTHEME +
guides(fill=guide_legend( title="Emissions sink or source",ncol=2, title.position="top", title.hjust = 0.5, override.aes=list(colour=NA))) +
theme(legend.position="bottom",
legend.key = element_rect(colour="white")) +
scale_fill_manual(breaks=c( "Biomass|Industry",  "Fossil|Industry", " ", "  ", "   ", " ",  "Iron and Steel", "Cement", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", "Industry"),
labels=c("BECCS (Industry)", "CCS (Industry)",  " ", "  ", "   ", " ", "Iron and Steel","Cement",  "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", "Other industries"),
values=c('#FFFFFF', '#FFFFFF', '#FFFFFF', '#FFFFFF','#B2E2E2', "red",'#E66101','#5A00FF','#2ca25f','grey40', '#fdb863','#c2a5cf','#7b3294'))
print(CUMUOFFSETindus)
print(CUMUOFFSETindus)
CUMUOFFSETindus=ggplot()+
geom_bar(data=fakeydata, aes(x=Region, y=value, fill=Variable), stat="identity", position="stack")+
geom_bar(data=CEMISrealsumcormutate[Model %in% c("IMAGE") & Variable %in% c("Biomass|Industry","Fossil|Industry") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=Diff, fill=Variable), stat="identity", position="stack", colour="black")+
annotate("rect", xmin=-Inf,xmax=Inf,ymin=0,ymax=Inf, fill="lightgrey") +
annotate("rect", xmin=-Inf,xmax=Inf,ymin=-Inf,ymax=0, fill="lightblue") +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8,y=-8900, label="CO[2]~Captured", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=0) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8,y=22500, label="CO[2]~emitted", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=1) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
# # "Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing"
geom_bar(data=CEMISrealsumcormutate[Model %in% c("IMAGE") & Variable %in% c("Biomass|Industry","Fossil|Industry") & Year %in% c("2030","2050") & Region %in% c("EU28", "JAP","CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=Diff, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Industry") & Year %in% c("2030","2050") & Region %in% c("EU28", "JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Pulp and Paper") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario %in% c("Baseline", "1.5 Degrees")], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals",  "Cement", "Food Processing") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Mt"~CO[2])) + ggtitle(bquote(bold("Cumulative emitted and captured"~CO[2]~"emissions since 2015"))) +
coord_flip(ylim = c(-8000:22000))+
facet_grid(Year~Scenario, scales="free") +
GROBTHEME +
guides(fill=guide_legend( title="Emissions sink or source",ncol=2, title.position="top", title.hjust = 0.5, override.aes=list(colour=NA))) +
theme(legend.position="bottom",
legend.key = element_rect(colour="white")) +
scale_fill_manual(breaks=c( "Biomass|Industry",  "Fossil|Industry", " ", "  ", "   ",   "Iron and Steel", "Cement", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", "Industry"),
labels=c("BECCS (Industry)", "CCS (Industry)",  " ", "  ", "   ",  "Iron and Steel","Cement",  "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", "Other industries"),
values=c('#FFFFFF', '#FFFFFF', '#FFFFFF', '#B2E2E2', "red",'#E66101','#5A00FF','#2ca25f','grey40', '#fdb863','#c2a5cf','#7b3294'))
print(CUMUOFFSETindus)
CUMUOFFSETindus=ggplot()+
geom_bar(data=fakeydata, aes(x=Region, y=value, fill=Variable), stat="identity", position="stack")+
geom_bar(data=CEMISrealsumcormutate[Model %in% c("IMAGE") & Variable %in% c("Biomass|Industry","Fossil|Industry") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=Diff, fill=Variable), stat="identity", position="stack", colour="black")+
annotate("rect", xmin=-Inf,xmax=Inf,ymin=0,ymax=Inf, fill="lightgrey") +
annotate("rect", xmin=-Inf,xmax=Inf,ymin=-Inf,ymax=0, fill="lightblue") +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8,y=-8900, label="CO[2]~Captured", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=0) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8,y=22500, label="CO[2]~emitted", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=1) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
# # "Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing"
geom_bar(data=CEMISrealsumcormutate[Model %in% c("IMAGE") & Variable %in% c("Biomass|Industry","Fossil|Industry") & Year %in% c("2030","2050") & Region %in% c("EU28", "JAP","CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=Diff, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Industry") & Year %in% c("2030","2050") & Region %in% c("EU28", "JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Pulp and Paper") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario %in% c("Baseline", "1.5 Degrees")], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals",  "Cement", "Food Processing") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Mt"~CO[2])) + ggtitle(bquote(bold("Cumulative emitted and captured"~CO[2]~"emissions since 2015"))) +
coord_flip(ylim = c(-8000:22000))+
facet_grid(Year~Scenario, scales="free") +
GROBTHEME +
guides(fill=guide_legend( title="Emissions sink or source",ncol=2, title.position="top", title.hjust = 0.5, override.aes=list(colour=NA))) +
theme(legend.position="bottom",
legend.key = element_rect(colour="white")) +
scale_fill_manual(breaks=c( "Biomass|Industry",  "Fossil|Industry", " ", "  ", "   ", "   ",  "Iron and Steel", "Cement", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", "Industry"),
labels=c("BECCS (Industry)", "CCS (Industry)",  " ", "  ", "   ", "   ", "Iron and Steel","Cement",  "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", "Other industries"),
values=c('#FFFFFF', '#FFFFFF', '#FFFFFF',  '#FFFFFF','#B2E2E2', "red",'#E66101','#5A00FF','#2ca25f','grey40', '#fdb863','#c2a5cf','#7b3294'))
print(CUMUOFFSETindus)
print(CUMUOFFSETindus)
fakeydata=data.table(Region=c(rep("USA", 8),rep("JAP", 8), rep("INDIA", 8),rep("CHN", 8), rep("CAN", 8),rep("BRA", 8),rep("EU28", 8)),
Variable=c(rep(c(" ", "  ", "   ", "    "),14)),
Year=c(rep(2030, 456)),
Scenario=c( rep(c("2 Degrees", "2 Degrees", "2 Degrees","2 Degrees","1.5 Degrees", "1.5 Degrees", "1.5 Degrees", "1.5 Degrees"),7)),
value=c(rep(0, 56)))
fakeydata2=data.table(Region=c(rep("USA", 8),rep("JAP", 8), rep("INDIA", 8),rep("CHN", 8), rep("CAN", 8),rep("BRA", 8),rep("EU28", 8)),
Variable=c(rep(c(" ", "  ", "   ", "    "),14)),
Year=c(rep(2050, 56)),
Scenario=c( rep(c("2 Degrees", "2 Degrees", "2 Degrees","2 Degrees","1.5 Degrees", "1.5 Degrees", "1.5 Degrees", "1.5 Degrees"),7)),
value=c(rep(0, 56)))
fakeydata=data.table(Region=c(rep("USA", 8),rep("JAP", 8), rep("INDIA", 8),rep("CHN", 8), rep("CAN", 8),rep("BRA", 8),rep("EU28", 8)),
Variable=c(rep(c(" ", "  ", "   ", "    "),14)),
Year=c(rep(2030, 56)),
Scenario=c( rep(c("2 Degrees", "2 Degrees", "2 Degrees","2 Degrees","1.5 Degrees", "1.5 Degrees", "1.5 Degrees", "1.5 Degrees"),7)),
value=c(rep(0, 56)))
fakeydata2=data.table(Region=c(rep("USA", 8),rep("JAP", 8), rep("INDIA", 8),rep("CHN", 8), rep("CAN", 8),rep("BRA", 8),rep("EU28", 8)),
Variable=c(rep(c(" ", "  ", "   ", "    "),14)),
Year=c(rep(2050, 56)),
Scenario=c( rep(c("2 Degrees", "2 Degrees", "2 Degrees","2 Degrees","1.5 Degrees", "1.5 Degrees", "1.5 Degrees", "1.5 Degrees"),7)),
value=c(rep(0, 56)))
fakeydata=rbind(fakeydata, fakeydata2)
fakeydata$Scenario <- factor(fakeydata$Scenario, levels=c("2 Degrees", "1.5 Degrees"))
fakeydata$Region<- factor(fakeydata$Region, levels=c( "EU28", "BRA","CAN","CHN","INDIA","JAP", "USA" ))
CUMUOFFSETindus=ggplot()+
geom_bar(data=fakeydata, aes(x=Region, y=value, fill=Variable), stat="identity", position="stack")+
geom_bar(data=CEMISrealsumcormutate[Model %in% c("IMAGE") & Variable %in% c("Biomass|Industry","Fossil|Industry") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=Diff, fill=Variable), stat="identity", position="stack", colour="black")+
annotate("rect", xmin=-Inf,xmax=Inf,ymin=0,ymax=Inf, fill="lightgrey") +
annotate("rect", xmin=-Inf,xmax=Inf,ymin=-Inf,ymax=0, fill="lightblue") +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8,y=-8900, label="CO[2]~Captured", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=0) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
annotate("text", x=0.8,y=22500, label="CO[2]~emitted", size=3, angle=0, colour="dimgrey", parse=TRUE, hjust=1) +  #geom_area(data=CEMISrealsumcor[Variable=="Fossil Fuels and Industry" & !Scenario=="Baseline" & Region %in% c("EU28", "World")], aes(x=as.numeric(Year), y=value, group=Variable,fill=Variable), position="stack")+
# # "Iron and Steel", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing"
geom_bar(data=CEMISrealsumcormutate[Model %in% c("IMAGE") & Variable %in% c("Biomass|Industry","Fossil|Industry") & Year %in% c("2030","2050") & Region %in% c("EU28", "JAP","CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=Diff, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Industry") & Year %in% c("2030","2050") & Region %in% c("EU28", "JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Pulp and Paper") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario %in% c("Baseline", "1.5 Degrees")], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_bar(data=CEMISrealsum[Model %in% c("IMAGE") & Variable %in% c("Iron and Steel", "Chemicals and Petrochemicals",  "Cement", "Food Processing") & Year %in% c("2030","2050") & Region %in% c("EU28","JAP", "CHN", "INDIA", "BRA", "CAN", "USA") & !Scenario=="Baseline"], aes(x=Region, y=value, fill=Variable), stat="identity", position="stack", colour="black")+
geom_hline(yintercept=0, linetype=1, size=1) +
xlab("Region") + ylab(bquote("Mt"~CO[2])) + ggtitle(bquote(bold("Cumulative emitted and captured"~CO[2]~"emissions since 2015"))) +
coord_flip(ylim = c(-8000:22000))+
facet_grid(Year~Scenario, scales="free") +
GROBTHEME +
guides(fill=guide_legend( title="Emissions sink or source",ncol=2, title.position="top", title.hjust = 0.5, override.aes=list(colour=NA))) +
theme(legend.position="bottom",
legend.key = element_rect(colour="white")) +
scale_fill_manual(breaks=c( "Biomass|Industry",  "Fossil|Industry", " ", "  ", "   ", "    ",  "Iron and Steel", "Cement", "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", "Industry"),
labels=c("BECCS (Industry)", "CCS (Industry)",  " ", "  ", "   ", "    ", "Iron and Steel","Cement",  "Chemicals and Petrochemicals", "Pulp and Paper", "Food Processing", "Other industries"),
values=c('#FFFFFF', '#FFFFFF', '#FFFFFF',  '#FFFFFF','#B2E2E2', "red",'#E66101','#5A00FF','#2ca25f','grey40', '#fdb863','#c2a5cf','#7b3294'))
print(CUMUOFFSETindus)
